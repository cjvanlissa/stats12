<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Book Description">
<title>4&nbsp; Hypothesis Testing – Statistics 1 and 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./glm1_regression.html" rel="next">
<link href="./samplingdistribution.html" rel="prev">
<link href="./images/logos/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
<link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/glossary.css">
<link rel="stylesheet" href="include/style.css">
<link rel="stylesheet" href="c:/gitbook_stats12/include/webex.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./testing.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics 1 and 2</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/cjvanlissa/stats12" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Statistics-1-and-2.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./samplingdistribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Sampling Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm1_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">GLM-I: Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm2_sum_squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">GLM-II: Sums of Squares</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm3binary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">GLM-III: Binary Predictors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm4anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">GLM-IV: ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm5multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">GLM-V: Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm6nested.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">GLM-VI: Nested models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm7interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">GLM-VII: Interaction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">GLM VIII - Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">GLM: Contrasts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">GLM: Factorial ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">GLM: ANCOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rmanova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">GLM: Repeated Measures ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reliability_validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Reliability and Validity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confint.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">BE2 - Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data for Portfolio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Z-table</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formula_sheet2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Formula sheet</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#lecture" id="toc-lecture" class="nav-link active" data-scroll-target="#lecture"><span class="header-section-number">5</span> Lecture</a></li>
  <li>
<a href="#statistical-power" id="toc-statistical-power" class="nav-link" data-scroll-target="#statistical-power"><span class="header-section-number">6</span> Statistical Power</a>
  <ul class="collapse">
<li>
<a href="#hypothesis-testing-type-i-and-type-ii-errors" id="toc-hypothesis-testing-type-i-and-type-ii-errors" class="nav-link" data-scroll-target="#hypothesis-testing-type-i-and-type-ii-errors"><span class="header-section-number">6.1</span> Hypothesis Testing: Type I and Type II Errors</a>
  <ul class="collapse">
<li><a href="#how-big-the-effect-is" id="toc-how-big-the-effect-is" class="nav-link" data-scroll-target="#how-big-the-effect-is"><span class="header-section-number">6.1.1</span> How big the effect is</a></li>
  <li><a href="#how-big-the-sample-is" id="toc-how-big-the-sample-is" class="nav-link" data-scroll-target="#how-big-the-sample-is"><span class="header-section-number">6.1.2</span> How big the sample is</a></li>
  <li><a href="#how-noisy-the-data-are" id="toc-how-noisy-the-data-are" class="nav-link" data-scroll-target="#how-noisy-the-data-are"><span class="header-section-number">6.1.3</span> How ‘noisy’ the data are</a></li>
  </ul>
</li>
  <li><a href="#power-of-a-test" id="toc-power-of-a-test" class="nav-link" data-scroll-target="#power-of-a-test"><span class="header-section-number">6.2</span> Power of a Test</a></li>
  <li><a href="#try-it-yourself" id="toc-try-it-yourself" class="nav-link" data-scroll-target="#try-it-yourself"><span class="header-section-number">6.3</span> Try it Yourself</a></li>
  </ul>
</li>
  <li><a href="#formative-test" id="toc-formative-test" class="nav-link" data-scroll-target="#formative-test"><span class="header-section-number">7</span> Formative Test</a></li>
  <li>
<a href="#tutorial" id="toc-tutorial" class="nav-link" data-scroll-target="#tutorial"><span class="header-section-number">8</span> Tutorial</a>
  <ul class="collapse">
<li><a href="#assignment-1-hypothesis-testing---formulating-hypotheses" id="toc-assignment-1-hypothesis-testing---formulating-hypotheses" class="nav-link" data-scroll-target="#assignment-1-hypothesis-testing---formulating-hypotheses"><span class="header-section-number">8.1</span> Assignment 1: Hypothesis Testing - Formulating Hypotheses</a></li>
  <li><a href="#assignment-2-test-statistics-alpha-and-significance" id="toc-assignment-2-test-statistics-alpha-and-significance" class="nav-link" data-scroll-target="#assignment-2-test-statistics-alpha-and-significance"><span class="header-section-number">8.2</span> Assignment 2: Test Statistics, Alpha and Significance</a></li>
  <li><a href="#assignment-3-z-test" id="toc-assignment-3-z-test" class="nav-link" data-scroll-target="#assignment-3-z-test"><span class="header-section-number">8.3</span> Assignment 3: Z-test</a></li>
  <li><a href="#quiz" id="toc-quiz" class="nav-link" data-scroll-target="#quiz"><span class="header-section-number">8.4</span> Quiz</a></li>
  <li><a href="#assignment-4-z-test-and-alpha-levels" id="toc-assignment-4-z-test-and-alpha-levels" class="nav-link" data-scroll-target="#assignment-4-z-test-and-alpha-levels"><span class="header-section-number">8.5</span> Assignment 4: Z-test and Alpha-levels</a></li>
  <li><a href="#quiz-1" id="toc-quiz-1" class="nav-link" data-scroll-target="#quiz-1"><span class="header-section-number">8.6</span> Quiz</a></li>
  <li><a href="#assignment-5-p-values" id="toc-assignment-5-p-values" class="nav-link" data-scroll-target="#assignment-5-p-values"><span class="header-section-number">8.7</span> Assignment 5: P-values</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-testing" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Hypothesis testing is a method of inferential statistics which allows researchers to draw conclusions about the population based on sample data. It involves formulating hypotheses, calculating test statistics, determining p-values, and drawing conclusions about the null hypothesis.</p>
<p>Hypothesis testing builds upon previously covered topics like sampling theory and estimation, where sample statistics are used as the best estimate of population parameters; standard errors to express the uncertainty surrounding those estimates; and probability calculus, using probability distributions - like the standard normal distribution - to compute the probability of observing certain values based on the sampling distribution.</p>
<p>To introduce the concept of hypothesis testing, let’s consider an intuitive example. Imagine your car won’t start, and you hypothesize that the battery is dead. You then perform an experiment by replacing the battery. If the car starts, you conclude that your initial hypothesis was correct - the battery was indeed dead.</p>
<p>In this thought experiment, you only need one piece of evidence. Statistical hypothesis instead rely on evidence from many observations, and use probability calculus to test hypotheses in the presence of uncertainty. Statistical tests use probability calculations to compute how probable it is to observe the sample data if the null hypothesis were true. If the resulting probability is very low, we may doubt whether the null hypothesis is indeed true.</p>
<p>The steps involved in hypothesis testing are as follows:</p>
<ol type="1">
<li>Formulate hypotheses: This involves stating a testable proposition about population parameters.</li>
<li>Calculate a test statistic: The test statistic describes how many standard errors away from the population statistic, under the null hypothesis, the sample statistic is.</li>
<li>Calculate the p-value: The p-value represents the probability of observing a value at least as extreme as the sample statistic, assuming the null hypothesis is true.</li>
<li>Draw a conclusion about the null hypothesis: Based on the p-value, we either reject or fail to reject the null hypothesis.</li>
</ol>
<p>Hypotheses can be formulated as equality or inequality statements. Equality hypotheses state that a value, difference, or effect is equal to zero, while inequality hypotheses state that a value, difference, or effect is larger or smaller than a specific value. It’s important to keep in mind that hypothesis testing does not provide evidence for hypotheses but rather helps in casting doubt on a null hypothesis.</p>
<p>In addition to the null hypothesis, we can also specify an alternative hypothesis. The specification of the alternative hypothesis depends on a bit of philosophy of science. Fisher’s philosophy suggests using only a null hypothesis; if this null hypothesis is rejected, the “truth” must be anything other than the null hypothesis. We could thus say that, according to Fisher’s philosophy, the alternative hypothesis is the negation of the null hypothesis. If <span class="math inline">\(H_0: \mu = 0\)</span>, then <span class="math inline">\(H_a: \mu \neq 0\)</span>; or, if <span class="math inline">\(H_0: \mu &gt; 0\)</span>, then <span class="math inline">\(H_a: \mu \leq 0\)</span>. The alternative hypothesis is in both cases the “opposite” of the null hypothesis.</p>
<p>Neyman-Pearson’s philosophy instead involves stating specific null and alternative hypotheses, with an explicit expected effect size for the alternative hypothesis. Assuming a specific expected effect size allows us to calculate the probabilities of drawing correct or incorrect conclusions.</p>
<p>In hypothesis testing, we calculate a test statistic, which measures the distance between the hypothesized population value and the sample statistic in terms of standard errors. The probability of observing a test statistic at least as extreme as the one we did observe is computed using an appropriate probability distribution. For many tests, we use either the Z-distribution or t-distribution, depending on whether we know the population standard deviation or not. This gives us a probability value (p-value), representing the probability of observing data as extreme as or more extreme than the sample data, assuming that the null hypothesis is true.</p>
<p>When interpreting p-values, it’s crucial to understand that they give the probability of observing certain data assuming the null hypothesis is true, rather than providing the probability of the null hypothesis being true or false. The p-value is then compared to a pre-determined significance level (usually denoted as alpha) to make a decision about accepting or rejecting the null hypothesis.</p>
<p>Rejecting the null hypothesis indicates that the observed data is unlikely to occur if the null hypothesis were true. On the other hand, failing to reject the null hypothesis means that the observed data is not surprising or does not provide sufficient evidence to reject it.</p>
<p>When testing hypotheses, we can make two types of errors: A Type I error refers to rejecting the null hypothesis when it is true (a false-positive conclusion), while Type II error refers to accepting the null hypothesis when it is false (failing to detect a true effect).</p>
<section id="lecture" class="level1" data-number="5"><h1 data-number="5">
<span class="header-section-number">5</span> Lecture</h1>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/-1J2Ge0B3Ro" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section><section id="statistical-power" class="level1" data-number="6"><h1 data-number="6">
<span class="header-section-number">6</span> Statistical Power</h1>
<section id="hypothesis-testing-type-i-and-type-ii-errors" class="level2" data-number="6.1"><h2 data-number="6.1" class="anchored" data-anchor-id="hypothesis-testing-type-i-and-type-ii-errors">
<span class="header-section-number">6.1</span> Hypothesis Testing: Type I and Type II Errors</h2>
<p>When we conduct a null-hypothesis significance test, we select the significance level <span class="math inline">\(\alpha\)</span>. Alpha is the probability of committing a Type I error (drawing a false-positive conclusion). Since we select the alpha level, it is known. If we use <span class="math inline">\(\alpha = .05\)</span>, that means that - by definition - we accept a 5% risk of committing a Type I error.</p>
<p>There is also the probability of committing a Type II error. This is called <span class="math inline">\(\beta\)</span>. We don’t know the value of <span class="math inline">\(\beta\)</span> beforehand, but we can calculate it if we make some assumptions. The probability of committing a Type II error (drawing a false-negative conclusion) depends on a few factors:</p>
<section id="how-big-the-effect-is" class="level3" data-number="6.1.1"><h3 data-number="6.1.1" class="anchored" data-anchor-id="how-big-the-effect-is">
<span class="header-section-number">6.1.1</span> How big the effect is</h3>
<p>Big effects are harder to miss; imagine trying to detect a difference between two groups. If the mean of both groups is really close together, it will be harder to detect a difference (see below):</p>
<div id="fig-effectsize" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-effectsize-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="testing_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="testing_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-effectsize-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.1: Effect of Effect Size
</figcaption></figure>
</div>
</section><section id="how-big-the-sample-is" class="level3" data-number="6.1.2"><h3 data-number="6.1.2" class="anchored" data-anchor-id="how-big-the-sample-is">
<span class="header-section-number">6.1.2</span> How big the sample is</h3>
<p>Large samples make it easier to detect smaller effects; imagine that the two distributions below are sampling distributions for two groups with very small sample sizes (left) and very large sample sizes (right):</p>
<div id="fig-effectsize" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-effectsize-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="testing_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="testing_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-effectsize-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6.2: Effect of Sample Size
</figcaption></figure>
</div>
</section><section id="how-noisy-the-data-are" class="level3" data-number="6.1.3"><h3 data-number="6.1.3" class="anchored" data-anchor-id="how-noisy-the-data-are">
<span class="header-section-number">6.1.3</span> How ‘noisy’ the data are</h3>
<p>The standard deviation is a measure of how “noisy” the data are. If observations are very spread out (high standard deviation), it will be harder to detect small differences. Consider that a small difference between two groups would be hard to detect if the two groups overlapped very much (= high standard deviation). Look at the same picture from the previous point (sample size); it illustrates this principle. The reason that both sample size and “noise in the data” have an impact on the probability of committing a Type II error is because they are used to calculate the standard error:</p>
<p><span class="math display">\[
SE_M = \frac{SD}{\sqrt{n}}
\]</span></p>
</section></section><section id="power-of-a-test" class="level2" data-number="6.2"><h2 data-number="6.2" class="anchored" data-anchor-id="power-of-a-test">
<span class="header-section-number">6.2</span> Power of a Test</h2>
<p>The “power” of a test is the probability that it will correctly detect a true effect of a specific size. Since <span class="math inline">\(\beta\)</span> is the probability of <em>missing</em> a true effect, it follows that <span class="math inline">\(1-\beta\)</span> must be the probability of <em>detecting</em> a true effect, or the power.</p>
<p>As explained in the previous paragraph, we must know a few pieces of information to be able to calculate <span class="math inline">\(\beta\)</span>:</p>
<ol type="1">
<li>Effect size</li>
<li>Sample size</li>
<li>Standard deviation</li>
</ol>
<p>When we conduct a study, we often know the sample size and standard deviation. The effect size is unknown, but we can assume a specific effect size. Think of this as an “informative” alternative hypothesis. The standard alternative hypothesis in null-hypothesis significance testing is just “anything that’s not the null hypothesis”. So if <span class="math inline">\(H_0: \mu = 0\)</span>, then <span class="math inline">\(H_a: \mu \neq 0\)</span>. Now, we must specify an exact value. For example, we could choose the smallest effect size of interest as the alternative hypothesis: Let’s say we’d be interested in a mean value of <span class="math inline">\(\mu = 0.2\)</span>. Then we could set our informative alternative hypothesis as <span class="math inline">\(H_i: \mu = 0.2\)</span>.</p>
<p>Now we have all the information needed to calculate the power of the test. To do so, we draw two sampling distributions (see illustration below): One (in red) centered around the null hypothesis, <span class="math inline">\(H_0: \mu = 0\)</span>, and one centered around the informative alternative hypothesis, <span class="math inline">\(H_i: \mu = 0.2\)</span>. We find the critical value in the red distribution around the null hypothesis; remember that <span class="math inline">\(\alpha\)</span> is the 5% of probability in the right tail of the red distribution. But we can now also calculate <span class="math inline">\(\beta\)</span>, the unknown probability in the tail of the blue distribution <strong>to the left</strong> of the critical value. If the informative alternative hypothesis is true, then this is the probability of failing to detect that true effect. Although this example has no numeric values, we see that the blue shaded area representing <span class="math inline">\(\beta\)</span> is slightly smaller than the red shaded area representing <span class="math inline">\(\alpha\)</span>, so the probability of committing a Type II error must be less than .05, and therefore the power <span class="math inline">\(1-\beta\)</span> must be greater than 95%! If our assumptions are correct, we’d be really well able to detect a true effect of the size specified under <span class="math inline">\(H_i\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="testing_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="try-it-yourself" class="level2" data-number="6.3"><h2 data-number="6.3" class="anchored" data-anchor-id="try-it-yourself">
<span class="header-section-number">6.3</span> Try it Yourself</h2>
<p>Now, let’s calculate this by hand. Imagine that last year’s average grade was <span class="math inline">\(M = 5\)</span>, with a standard deviation of <span class="math inline">\(SD = 1.5\)</span>. This year, we have 73 students. We’ve made some changes to the teaching material, and we hope to reach an average grade of <span class="math inline">\(M = 6\)</span>.</p>
<p>Assume that the standard deviation this year will be the same as last year, and calculate the power of being able to detect a mean grade of <span class="math inline">\(H_i: \mu = 6\)</span> when the null hypothesis is that the mean grade is the same as last year, <span class="math inline">\(H_0: \mu = 5\)</span>.</p>
<p><strong>Step 1: Calculate the SE</strong></p>
<p>We calculate the SE as <span class="math inline">\(SE = \frac{SD}{\sqrt{n}} = \frac{1.5}{\sqrt{73}} = 0.18\)</span></p>
<p><strong>Step 2: Calculate Critical Value</strong></p>
<p>The critical value is the boundary that corresponds to <span class="math inline">\(\alpha = .05\)</span> in the distribution centered around <span class="math inline">\(H_0\)</span>. Looking at the t- or Z-table (because sample size is &gt;&gt;30), we see that this corresponds to a Z-value of about 1.64.</p>
<p><img src="./z-05.png" class="img-fluid"></p>
<p>Converting this back to a score on the grades scale, we get:</p>
<p><span class="math display">\[
\text{Grade}_{\text{critical}} = (Z_{\text{critical}} * SE) + \mu_{H_0} = (1.64 * 0.18) + 5 = 5.3
\]</span></p>
<p><strong>Step 3: Get Left-Tail Probability for That Value</strong></p>
<p>Now, we just need to get the left-tail probability for that critical value, in the blue distribution. Convert that critical value back to a Z-value, but now in the blue distribution which is centered around <span class="math inline">\(\mu_{H_i} = 6\)</span>:</p>
<p><span class="math display">\[
Z = \frac{\text{Grade}_{\text{critical}}-\mu_{H_i}}{SE} = \frac{5.3 - 6}{0.18}  = -3.89
\]</span></p>
<p>This is an extremely large (negative) Z-value; it’s not even in our table. Thus, the left-tail probability <span class="math inline">\(\beta\)</span> will be tiny - <span class="math inline">\(\beta &lt; .01\)</span>.</p>
<p><strong>That means that our power to detect a true effect of 6 would be very high - <span class="math inline">\(1-\beta = 1-.01 = .99\)</span>, 99%!</strong></p>
</section></section><section id="formative-test" class="level1" data-number="7"><h1 data-number="7">
<span class="header-section-number">7</span> Formative Test</h1>
<p>A formative test helps you assess your progress in the course, and helps you address any blind spots in your understanding of the material. If you get a question wrong, you will receive a hint on how to improve your understanding of the material.</p>
<p>Complete the formative test ideally after you’ve seen the lecture, but before the lecture meeting in which we can discuss any topics that need more attention</p>
<div class="cell" data-layout-align="center">
<div class="webex-check webex-box">
<p><strong>Question 1</strong></p>
For a two-tailed Z-test of the sample mean, the p-value is the probability of finding a more extreme sample mean than the observed sample mean, if the alternative hypothesis were true.
<div id="radio_PVEBXCFVPK" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_PVEBXCFVPK" value="answer"><span>FALSE</span></label><label><input type="radio" autocomplete="off" name="radio_PVEBXCFVPK" value=""><span>TRUE</span></label>
</div>
<p><strong>Question 2</strong></p>
A researcher performs a Z-test to test the hypotheses H0: mu = 0 versus H1: mu &gt; 0. She finds a test statistic of Z = 2.03 and a one-tailed p-value of 0.02. Statement: If the researcher had performed a two-tailed Z-test, the value of the two-tailed p-value would have been halved: 0.01.
<div id="radio_ATNYQICLYF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ATNYQICLYF" value="answer"><span>FALSE</span></label><label><input type="radio" autocomplete="off" name="radio_ATNYQICLYF" value=""><span>TRUE</span></label>
</div>
<p><strong>Question 3</strong></p>
Chris expects that people who have bungee jumped will score high on average on the Big 5 personality trait ‘Openness to Experience’. Openness to Experience has been measured on a 10 point scale (1= not at all open, 10 = extremely open). He takes a random sample of 45 persons who have bungee jumped and observes a mean of 6 and SD of 1.954. He tests the following hypotheses: H0: mu =&lt; 5.5 versus H1: mu &gt; 5.5 with a one-sample t-test. He assumes that Openness to Experience is normally distributed in the population. What is the smallest significance level for which Chris can reject the null hypothesis?
<div id="radio_YRVEGQDYMR" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_YRVEGQDYMR" value="answer"><span>0.05</span></label><label><input type="radio" autocomplete="off" name="radio_YRVEGQDYMR" value=""><span>0.1</span></label><label><input type="radio" autocomplete="off" name="radio_YRVEGQDYMR" value=""><span>0.01</span></label><label><input type="radio" autocomplete="off" name="radio_YRVEGQDYMR" value=""><span>Cannot reject H0</span></label>
</div>
<p><strong>Question 4</strong></p>
What is the purpose of inferential statistics?
<div id="radio_LKQLMNFPJL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LKQLMNFPJL" value=""><span>Estimation of population parameters</span></label><label><input type="radio" autocomplete="off" name="radio_LKQLMNFPJL" value=""><span>Testing the null hypothesis</span></label><label><input type="radio" autocomplete="off" name="radio_LKQLMNFPJL" value=""><span>Calculating sample statistics</span></label><label><input type="radio" autocomplete="off" name="radio_LKQLMNFPJL" value="answer"><span>Using sample data to infer properties of the population</span></label>
</div>
<p><strong>Question 5</strong></p>
What is the standard error?
<div id="radio_MZSBGMPVSI" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MZSBGMPVSI" value="answer"><span>An estimate of the average sampling error when estimating a population parameter using a sample statistic</span></label><label><input type="radio" autocomplete="off" name="radio_MZSBGMPVSI" value=""><span>An estimate of the uncertainty about the sample statistic</span></label><label><input type="radio" autocomplete="off" name="radio_MZSBGMPVSI" value=""><span>The spread of the sample data</span></label><label><input type="radio" autocomplete="off" name="radio_MZSBGMPVSI" value=""><span>An estimate of the uncertainty about the average of the sample values</span></label>
</div>
<p><strong>Question 6</strong></p>
What is a hypothesis in the context of statistical testing?
<div id="radio_TDLOIPZOAE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_TDLOIPZOAE" value=""><span>Something you want to know about the population</span></label><label><input type="radio" autocomplete="off" name="radio_TDLOIPZOAE" value="answer"><span>A proposition about the population that can be tested in a sample</span></label><label><input type="radio" autocomplete="off" name="radio_TDLOIPZOAE" value=""><span>A statement that some parameter is equal to zero</span></label><label><input type="radio" autocomplete="off" name="radio_TDLOIPZOAE" value=""><span>An explanation for observed phenomena</span></label>
</div>
<p><strong>Question 7</strong></p>
What is meant by ‘power’ in statistical testing?
<div id="radio_MGSYGVSUYF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_MGSYGVSUYF" value=""><span>The probability of rejecting the null hypothesis</span></label><label><input type="radio" autocomplete="off" name="radio_MGSYGVSUYF" value="answer"><span>The probability of correctly finding a true effect</span></label><label><input type="radio" autocomplete="off" name="radio_MGSYGVSUYF" value=""><span>The probability of committing a Type II error</span></label><label><input type="radio" autocomplete="off" name="radio_MGSYGVSUYF" value=""><span>The probability of committing a Type I error</span></label>
</div>
<p><strong>Question 8</strong></p>
You want to test if the mean height of a sample of 50 students is significantly different from the population mean of 65 inches. The sample mean is 68 inches, and the standard deviation is 2 inches. What is the calculated t-value for this hypothesis test?
<div id="radio_XVXKOKNRKE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XVXKOKNRKE" value=""><span>1.50</span></label><label><input type="radio" autocomplete="off" name="radio_XVXKOKNRKE" value="answer"><span>10.61</span></label><label><input type="radio" autocomplete="off" name="radio_XVXKOKNRKE" value=""><span>75.00</span></label><label><input type="radio" autocomplete="off" name="radio_XVXKOKNRKE" value=""><span>240.42</span></label>
</div>
<p><strong>Question 9</strong></p>
You want to test if the average time spent on a particular task is different from 30 minutes. You collect a sample of 25 participants, and the sample mean time spent on the task is 28 minutes with a standard deviation of 3 minutes. Conducting a two-tailed t-test, what is the calculated t-value?
<div id="radio_YBNAYIFILF" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_YBNAYIFILF" value=""><span>3.33</span></label><label><input type="radio" autocomplete="off" name="radio_YBNAYIFILF" value=""><span>-0.67</span></label><label><input type="radio" autocomplete="off" name="radio_YBNAYIFILF" value="answer"><span>-3.33</span></label><label><input type="radio" autocomplete="off" name="radio_YBNAYIFILF" value=""><span>-16.67</span></label>
</div>
</div>
<div class="webex-solution">
<button>
Show explanations
</button>
<p><strong>Question 1</strong></p>
<p>When calculating a test statistic, we assume the null hypothesis to be true - not the alternative hypothesis.</p>
<p><strong>Question 2</strong></p>
<p>The p-value for a two-tailed test is twice as large as for a one-tailed test (because you have the same one-tailed probability in both tails). For two-tailed tests, if the observed effect is in the direction of the alternative hypothesis, you can half the two-tailed p-value.</p>
<p><strong>Question 3</strong></p>
<p>Divide the standard deviation by the square root of 45 to get the standard error. Then, divide the difference between the observed mean of 6 and the hypothesized mean of 5.5 by that standard error to get the test statistic. Then, find the critical t-values for a one-sided test with the three alpha levels mentioned in the answers in the t-distribution for 44 degrees of freedom (n - 1). Note that the answer is .05!</p>
<p><strong>Question 4</strong></p>
<p>Inferential statistics involves using sample data to make inferences or draw conclusions about the larger population from which the sample was drawn. It allows researchers to make educated guesses about population parameters based on the information collected from the sample. Calculating sample statistics is a step in the inferential process, but it is not the primary purpose of inferential statistics. Testing the null hypothesis is another inferential procedure, but it is a specific type of hypothesis testing, and not the overall purpose of inferential statistics.</p>
<p><strong>Question 5</strong></p>
<p>The standard error is a measure of the uncertainty associated with the sample statistic as estimator of the population parameter. It represents how much the sample statistic is expected to vary from one sample to another if multiple samples were drawn from the same population.</p>
<p><strong>Question 6</strong></p>
<p>In statistical testing, a hypothesis is a testable proposition about the population that can be examined using sample data. It is a statement or assumption that researchers put to the test to determine if there is evidence to support it or not. The hypothesis is formulated based on the theory or observations made about the population.</p>
<p><strong>Question 7</strong></p>
<p>Power in statistical testing refers to the probability of correctly detecting a true effect or relationship between variables. It is the likelihood of finding a significant result in a study when the effect being investigated truly exists in the population. It is important to have sufficient power in a study to avoid false-negative findings, where we fail to reject the null hypothesis when there is a real effect. Power is one minus the probability of committing a Type II error, or 1-beta.</p>
<p><strong>Question 8</strong></p>
<p>To calculate the t-value for this hypothesis test, you can use the formula: t = (sample mean - population mean) / (standard deviation / square root of sample size). Plugging in the values, t = (68 - 65) / (2 / sqrt(50)) = 10.61.</p>
<p><strong>Question 9</strong></p>
<p>The t-value for a two-tailed t-test can be calculated using the formula: t = (sample mean - population mean) / (standard deviation / square root of sample size). In this case, the population mean is 30 minutes. Plugging in the values, t = (28 - 30) / (3 / sqrt(25)) = -3.33.</p>
</div>
</div>
</section><section id="tutorial" class="level1" data-number="8"><h1 data-number="8">
<span class="header-section-number">8</span> Tutorial</h1>
<section id="assignment-1-hypothesis-testing---formulating-hypotheses" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="assignment-1-hypothesis-testing---formulating-hypotheses">
<span class="header-section-number">8.1</span> Assignment 1: Hypothesis Testing - Formulating Hypotheses</h2>
<p>Discuss with your portfolio group the logic behind hypothesis testing, and how it relates to your personal (and group’s) research interests.</p>
<p>Consider the following three research descriptions. Formulate H0 and H1 in words. Discuss your answers with your group members.</p>
<p>Researchers want to know whether it matters for test performance if an exam is completed on a computer or using paper and pencil. Hence, the research question reads: Is there an effect of the type of administration (computer or paper and pencil) on the test performance?</p>
<p>What would be the H0 and HA for this study?</p>
<div class="webex-solution">
<button>
Show answer
</button>
<p>This appears to be an undirected hypothesis about a mean difference for two independent samples, without a clearly specified alternative hypothesis. Thus, we could state:</p>
<p><span class="math inline">\(H_0: \mu_{computer} = \mu_{paper}\)</span> <span class="math inline">\(H_A: \mu_{computer} \neq \mu_{paper}\)</span></p>
</div>
<p>Researchers want to know whether the alcohol consumption among Dutch students differs from the alcohol consumption in the general Dutch population. Using CBS statistics, they know that in the general population the average alcohol consumption is 5.6 glasses a week. The question is whether the average alcohol consumption among students is different from this national average.</p>
<p>What would be the H0 and H1 for this study?</p>
<div class="webex-solution">
<button>
Show answer
</button>
<p>This appears to be an undirected hypothesis about the difference between a mean and a hypothesized value, without a clearly specified alternative hypothesis. Thus, we could state:</p>
<p><span class="math inline">\(H_0: \mu = 5.6\)</span> <span class="math inline">\(H_A: \mu \neq 5.6\)</span></p>
</div>
<p>Researchers want to study whether social isolation is associated with income.</p>
<p>What would be the H0 and H1 for this study?</p>
<div class="webex-solution">
<button>
Show answer
</button>
<p>This appears to be an undirected hypothesis about an association between two variables, without a clearly specified alternative hypothesis. We could thus state:</p>
<p><span class="math inline">\(H_0: \rho = 0\)</span> <span class="math inline">\(H_A: \rho \neq 0\)</span></p>
</div>
<p>Formulating the hypothesis is an important very first step in hypotheses testing. Continue with the next assignment, in which we will go through the steps of a hypothesis test.</p>
</section><section id="assignment-2-test-statistics-alpha-and-significance" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="assignment-2-test-statistics-alpha-and-significance">
<span class="header-section-number">8.2</span> Assignment 2: Test Statistics, Alpha and Significance</h2>
<p>In this assignment we will go through the steps of a hypothesis test.</p>
<p>While going through the steps we will come across the most important concepts related to hypothesis testing.</p>
<p>For the next steps, we consider the following situation:</p>
<p>Suppose we are interested in the personality profile of musicians; that is, we want to know whether, on average, personality characteristics of musicians differ from those of the general population. For now, we’ll only focus on Openness. We pretend that we have collected data among 25 musicians using a validated scale for which previous research has shown that in the general population the scores are normally distributed with mean 50 and SD 15. It is our task to test whether the mean of Openness for musicians differs from the mean in the general population. To keep things simple, we assume that in the population of musicians the SD is the same as in the general population; that is, we assume that LaTeX: <span class="math inline">\(\sigma = 15\)</span>.</p>
<p>Let openness be the variable of interest. Let <span class="math inline">\(\mu_{musicians}\)</span> represent the mean openness in the population of musicians. The hypothesis test amounts to testing:</p>
<p><span class="math inline">\(H0: \mu_{musicians} = 50\)</span></p>
<p><span class="math inline">\(H1: \mu_{musicians} \neq 50\)</span></p>
<p>Now, when we do the hypothesis test, we seek for evidence against the null hypothesis. More specifically, our testing procedure starts with the assumption that H0 represents the truth and as long as we don’t have convincing evidence that our assumption is false we stick to that assumption.</p>
<p>The question is, however, when do we have convincing evidence against H0?</p>
<p>Finding evidence against H0 works as follows:</p>
<p>If H0 is true, we expect mean values close to H0. And, if we observe a mean value that is much different from the value under H0, we have convincing evidence against H0. If this happens, we reject H0 as representing the truth and accept the alternative hypothesis, H1.</p>
<p>Hypothesis testing fits Popper’s philosophy of falsification. He introduced this well-known analogy to explain the logic of falsificationism:</p>
<ol type="1">
<li>Suppose we assume that all Swans are white, <span class="math inline">\(H_0: Swans = white\)</span>
</li>
<li>We would then not expect to observe black ones.</li>
<li>If we do observe black swans, our initial hypothesis is called into question.</li>
<li>The number of white swans we see (= observations consistent with the hypothesis) does not provide evidence for <span class="math inline">\(H_0\)</span>, because there could always be a black swan out there we haven’t observed yet.</li>
</ol>
<p>So, the next questions are:</p>
<p>What are the sample values we can expect under H0? When is evidence “convincing” enough? To answer the first question we have to go back to sampling distributions!</p>
<p>For the second question, we need a criterion. We have to realize that even if H0 is true, sample values can be far off just by sampling fluctuations (i.e., by chance). The common criterion is: if the observed value is among the 5% most unlikely samples under H0 (i.e.&nbsp;if H0 is true), we reject the null hypothesis.</p>
<p>Let’s go back to our example about musicians.</p>
<p>Let X be openness. Under H0 we assume that X is normally distributed with mean 50 and SD equal to 15.</p>
<p>What are the mean and standard deviation of the sampling distribution of the mean under H0 given that the sample size is 25? And what do we call the standard deviation of the sampling distribution?</p>
<p>(Use what you have learned in the previous lectures. Hint: first make a drawing of the situation, then do the computations).</p>
<div class="webex-solution">
<button>
Explanation
</button>
<p>Sampling distribution:</p>
<ul>
<li>Mean: <span class="math inline">\(\mu = 50\)</span>
</li>
<li>Standard error ( =SD of sampling distribution!): <span class="math inline">\(\sigma_{\bar{X}} = \frac{15}{\sqrt{25}}= 3\)</span>
</li>
</ul>
</div>
<p>Suppose we want to indicate sample means that are unlikely if H0 would be true. In particular, we want to know how far the sample mean must be from the hypothesized mean to be among the 5% of all possible samples under H0 that are furthest away from the hypothesized means.</p>
<p>What should the value of the sample mean be to fall within the 5% most deviant samples if the sample size is 25?</p>
<div class="webex-solution">
<button>
Explanation
</button>
<p>We are talking about the distribution of the mean; so we need to work with the sampling distribution. We want to know the cut offs that mark the 2.5% highest and 2.5% lowest means. We first have to find the Z-values: they are 1.96 for the highest 2.5%, and (by symmetry) -1.96 marks the 2.5% lowest.</p>
<p>Hence, to be among the 5% of all possible sample means that are most unlikely under H0, the sample mean should be:</p>
<p>larger than 50+1.96 x 3 = 55.88 or smaller than 50-1.96 x 3 = 44.12</p>
</div>
<p>Let’s do some more exercises on the Z-test.</p>
<p>Suppose the mean for Openness we found in our sample was 59.</p>
<p>If we use a significance level of 5%, would we reject the null hypothesis? <select class="webex-select"><option value="blank"></option>
<option value="answer">Yes</option>
<option value="">No</option></select></p>
<p>In the previous step we used cut offs for the sample means to decide about significance. The cut off scores were obtained via the Z-distribution. However, doing all these computations is not necessary (there’s a shortcut!!). In fact, if we know the Z-value for the sample, we can easily find out if the sample is among the 5% of the most unlikely sample means. We only have to compare the value with 1.96 and -1.96 to see whether that is the case.</p>
<p>In this course, we will use Z-values for different purposes. In these specific calculations, Z is used as a <em>Test Statistic</em>. A test statistic quantifies evidence against the null hypothesis. In this case, the Z test statistic expresses how far away from the mean under the null hypothesis the observed mean is, in terms of the number of standard errors.</p>
<p>The Z test-statistic follows the standard normal distribution. The values 1.96 and -1.96 are called the critical values and they mark the 5% most unlikely sample means under H0. In other words, the critical values mark the reject region for H0.</p>
<p>So, if we compute the Z-value for the sample mean, and if that sample value of Z falls in the rejection region, we reject H0 (we found something that is unlikely enough to no longer believe H0 is true). If H0 is rejected we speak of a significant result. See the graph below:</p>
<p><img src="images/LAS_3_2_Graph-1-1.jpg" class="img-fluid"></p>
<p>Following these steps to test a mean is one example of performing a <em>“Z-test”</em>!</p>
<p>We can use the Z-test to test hypotheses about the population mean if we know the population <span class="math inline">\(\sigma\)</span>.</p>
<p>The test statistic for the Z-test is:</p>
<p><span class="math inline">\(z  = \frac{\bar{X}-\mu_{H_0}}{\sigma_{\bar{X}}}\)</span></p>
<p>This statistic is computed using the mean from the sample, the hypothesized mean under H0 and <span class="math inline">\(\sigma\)</span>.</p>
<p>H0 is rejected at the 5% significance level if z is either larger than 1.96 or smaller than -1.96.</p>
<p>So far, we rejected the null hypothesis if the sample is among the 5% most unlikely sample means under H0. This 5% was called the significance level, and is denoted as <span class="math inline">\(\alpha = .05\)</span>. However, we could just as well choose 1% or .5%.</p>
<p>What would be the critical values for the Z-test if one tests at <span class="math inline">\(\alpha = .01\)</span>? <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer="[&quot;2.58&quot;]"></p>
<p>What would be the critical values for the Z-test if one tests at <span class="math inline">\(\alpha = .005\%\)</span>? <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer="[&quot;2.81&quot;]"></p>
<p>For historical reasons, social scientists tend to use <span class="math inline">\(\alpha = 0.05\)</span> as a default. So in this course, if alpha is not explicitly stated, assume <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>When we test hypotheses we reject H0 if the sample we find is unlikely if H0 is true. However, the flip side is that, even though H0 is true, we may find a sample that is much different by chance, and erroneously reject H0. Or, in other words, we could make an error. Rejecting H0 while it is true in reality is called a Type I error!</p>
<p>Consider the following:</p>
<ol type="1">
<li>If H0 is true, and you test at <span class="math inline">\(\alpha = 0.05\)</span>, what is the probability of committing a Type I error?</li>
<li>What is the link between the <span class="math inline">\(\alpha\)</span>-level and type I error rate?</li>
</ol>
<div class="webex-solution">
<button>
Explanation
</button>
<ol type="1">
<li><p>If H0 is really true (i.e., H0 should not be rejected), then the probability that the sample mean is among the 5% most unlikely is equal to 5%.</p></li>
<li><p>The alpha level specifies the risk of a Type I error. So if one tests at an alpha level of .05, it means that one accepts a risk of 5% to commit a Type I error.</p></li>
</ol>
</div>
<p>Properties of the Z-test:</p>
<p>Used to test hypotheses about the mean in a population, assuming <span class="math inline">\(\sigma\)</span> known.</p>
<p>The test-statistic equals <span class="math inline">\(z = \frac{\bar{X}-\mu}{\sigma_{\bar{X}}}\)</span></p>
<p>The test statistic is normally distributed.</p>
</section><section id="assignment-3-z-test" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="assignment-3-z-test">
<span class="header-section-number">8.3</span> Assignment 3: Z-test</h2>
<p>In this assignment we will apply the Z-test.</p>
<p>This assignment first presents an example, followed by two practice questions.</p>
<p>A researcher wants to test <span class="math inline">\(H_0: \mu = 50\)</span> against <span class="math inline">\(H_1: \mu \neq 50\)</span></p>
<p>Data are available from a random sample of 26 respondents. The mean was 53.7. The researcher assumes the SD in the population is 8.5. Perform all steps of the Z-test.</p>
<div class="webex-solution">
<button>
Explanation
</button>
<p>Step 1: Formulate hypotheses</p>
<p><span class="math inline">\(H_0: \mu = 50\)</span> <span class="math inline">\(H_1: \mu \neq 50\)</span></p>
<p>Step 2: Compute test statistic</p>
<p>Standard error: <span class="math inline">\(\frac{8.5}{\sqrt{26}}=1.667\)</span></p>
<p>Test statistic: <span class="math inline">\(z = \frac{53.7-50}{1.667}=2.212\)</span></p>
<p>Step 3: Decide about significance</p>
<p><span class="math inline">\(\alpha = .05\)</span>, so critical values +/- 1.96.</p>
<p>Our test statistic exceeds this critical value.</p>
<p>The sample mean thus falls in the rejection region, and we should conclude that the test is significant so <span class="math inline">\(H_0\)</span> s rejected.</p>
<p>Step 4: Draw conclusion</p>
<p>We have convincing evidence that the population mean differs from 50.</p>
</div>
<p>A researcher wants to test whether the population mean is equal to 80. Data are available from a random sample of 60 respondents. The mean was 74. The researchers assume the SD in the population is 40. Perform and report all steps of the Z-test. What is the resulting p-value? <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer="[&quot;0.12&quot;,&quot;.12&quot;]"></p>
<p>A researcher wants to test whether the population mean is equal to 500. Data are available from a random sample of 75 respondents. The mean was 546. The researchers assume that the SD in the population is 200. Perform all steps of the Z-test. Use <span class="math inline">\(\alpha = .01\)</span>. Perform and report all steps.</p>
<div class="webex-solution">
<button>
Show answer
</button>
<p>Step 1: Hypotheses: <span class="math inline">\(H_0: \mu=500\)</span>, <span class="math inline">\(H_1: \mu \neq 500\)</span></p>
<p>step 2: Compute Statistic:</p>
<ul>
<li>standard error: <span class="math inline">\(\frac{200}{\sqrt{75}} = 23.094\)</span>
</li>
<li>test statistic: <span class="math inline">\(z  = \frac{546-500}{23.094}=1.992\)</span>
</li>
</ul>
<p>Step 3: Decide about significance.</p>
<p>Z does not exceed +/- 2.576. This means that Z does not fall in the reject region when tested at the 1% significance level. The test is not significant.</p>
<p>Step 4: Draw conclusion</p>
<p><span class="math inline">\(H_0\)</span> is not rejected.</p>
</div>
</section><section id="quiz" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="quiz">
<span class="header-section-number">8.4</span> Quiz</h2>
<div class="webex-check webex-box">
<p>“The null and alternative hypothesis are deduced from the data.” <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>“When performing a hypothesis test, we start by assuming <span class="math inline">\(H_0\)</span> is true.” <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<p>“If we reject <span class="math inline">\(H_0\)</span> with <span class="math inline">\(\alpha=0.05\)</span>, then we will also reject it at <span class="math inline">\(\alpha=0.10\)</span>, assuming all other quantities are held constant.” <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<div class="webex-solution">
<button>
Explanation
</button>
<p>The critical values of <span class="math inline">\(\alpha =0.05\)</span> are +/- 1.96. Hence, if <span class="math inline">\(H_0\)</span> is rejected it means that z in the sample is larger than 1.96 or smaller than -1.96.”</p>
<p>The critical values of <span class="math inline">\(\alpha =0.1\)</span> are +/- 1.645. This means that for rejecting <span class="math inline">\(H_0\)</span> at this alpha level, that z should be larger than 1.645 or smaller than -1.645. That is implied by the fact that it exceeds +/- 1.96.</p>
</div>
<p>“If we reject <span class="math inline">\(H_0\)</span>, then <span class="math inline">\(H_0\)</span> is surely wrong.” <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<div class="webex-solution">
<button>
Explanation
</button>
<p>We should always be aware of the possibility of making a Type I error. The probability of making a Type I error is equal to <span class="math inline">\(\alpha\)</span>.</p>
</div>
<p>“Increasing the sample size n (and holding all the rest constant) decreases the probability of a Type I error.” <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<div class="webex-solution">
<button>
Explanation
</button>
<p>Increasing the sample size n (and holding all the rest constant) does not decrease the probability of a Type I error.</p>
<p>The Type I error is determined by the alpha level.</p>
<p>If our sample is among the 5% most unlikely sample means of all possible sample means with the same size under <span class="math inline">\(H_0\)</span>, whatever that sample size N may be.</p>
<p>Increasing the sample size n (and holding all the rest constant) does not decrease the probability of a Type I error.</p>
</div>
</div>
</section><section id="assignment-4-z-test-and-alpha-levels" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="assignment-4-z-test-and-alpha-levels">
<span class="header-section-number">8.5</span> Assignment 4: Z-test and Alpha-levels</h2>
<p>In this assignment we will practice some more with the Z-test, meanwhile we will review important concepts of hypothesis testing. In particular, we will look at significance levels.</p>
<p>To test hypotheses, we need to specify the “significance level”, usually denoted by <span class="math inline">\(\alpha\)</span>. The significance level is our <em>decision criterion</em> to reject H0.</p>
<p>The most common choice is .05. But what does this criterion exactly entail?</p>
<p>Discuss with your group what an <span class="math inline">\(\alpha\)</span> level entails.</p>
<div class="webex-solution">
<button>
Explanation
</button>
<p>If we test at an <span class="math inline">\(\alpha\)</span> of .05 it means that we are willing to reject H0 in favor of H1 if our sample mean belongs to the 5% most extreme scores (2.5% in each tail) under the null hypothesis.</p>
<p>If indeed the sample mean is among this 5%, it means that we have observed a sample in a range that is quite unlikely if the null hypothesis would be true and, therefore, justifies rejection of the null hypothesis.</p>
</div>
<p>In the previous assignments you already used the critical values for the Z-test for specific alpha levels.</p>
<p>For two-tailed tests, it holds that if the absolute value of Z exceeds the critical value, we may reject <span class="math inline">\(H_0\)</span>.</p>
<p>Let <span class="math inline">\(Z_\text{crit}\)</span> be the critical value. For the Z-test it holds that:</p>
<ul>
<li>
<span class="math inline">\(Z_\text{crit} = 1.65\)</span>, if <span class="math inline">\(\alpha = 0.10\)</span> (two-tailed)</li>
<li>
<span class="math inline">\(Z_\text{crit} = 1.96\)</span>, if <span class="math inline">\(\alpha = 0.05\)</span> (two-tailed)</li>
<li>
<span class="math inline">\(Z_\text{crit} = 2.58\)</span>, if <span class="math inline">\(\alpha = 0.01\)</span> (two-tailed)</li>
</ul></section><section id="quiz-1" class="level2" data-number="8.6"><h2 data-number="8.6" class="anchored" data-anchor-id="quiz-1">
<span class="header-section-number">8.6</span> Quiz</h2>
<div class="webex-check webex-box">
<p>Researchers want to test whether <span class="math inline">\(\mu=70\)</span>. They assume that <span class="math inline">\(\sigma = 10\)</span>. Researchers found a mean of 72 in a random sample of 40 persons.</p>
<p>True or false:</p>
<p><span class="math inline">\(H_0\)</span> can be rejected at one of the three levels discussed above (<span class="math inline">\(\alpha = .10, .05, .01\)</span>. <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>“If the two-tailed test is significant at the 5% level, it will also be significant at the 1% level (keeping everything else fixed).” <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>“If the two-tailed test is not significant at the 10% level, it won’t be significant at the 5% level either (keeping everything else fixed).” <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<p>“If the two-tailed test is not significant at the 5% level, it could still be significant at the 10% level (keeping everything else fixed).” <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<p>“If the two-tailed test is significant at the 1% level, it might not be significant at the 5% level (keeping everything else fixed).” <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
</div>
</section><section id="assignment-5-p-values" class="level2" data-number="8.7"><h2 data-number="8.7" class="anchored" data-anchor-id="assignment-5-p-values">
<span class="header-section-number">8.7</span> Assignment 5: P-values</h2>
<p>We will now focus on the interpretation of the p-values and how to use the p-values to decide about significance.</p>
<p>Consider the following situation:</p>
<p>Scores on a test measuring confidence in police are normally distributed in the general population, with <span class="math inline">\(\mu = 500\)</span> and an <span class="math inline">\(\sigma = 50\)</span>. Researchers want to know if the average confidence level is different for those who have been a victim of crime. They collect data for 60 victims. They find a sample mean of 511. They test <span class="math inline">\(H_0: \mu = 500\)</span> against <span class="math inline">\(H_1: \mu \neq 500\)</span>, while assuming that the population variance is <span class="math inline">\(\sigma = 50\)</span>.</p>
<p>Compute the p-value. Draw a graph for the two-tailed p-value. Write down in your own words and as precise as possible the interpretation of the p-value in the answer box below. Then, discuss your response with your group.</p>
<div class="webex-solution">
<button>
Explanation
</button>
<ul>
<li>The p-value represents the proportion of all possible sample means that are further away from our hypothesized mean than the observed sample mean is.</li>
<li>We have the sampling distribution with <span class="math inline">\(\mu = 500\)</span> and <span class="math inline">\(\sigma_{\bar{X}} = \frac{50}{\sqrt{60}} = 6.455\)</span>.</li>
<li>First, we compute the right-tail area: <span class="math inline">\(P(\bar{X} &gt; 511) = P(Z &gt; 1.70) = 0.0446\)</span>.</li>
<li>Hence, 4.66% of all possible samples is further away from <span class="math inline">\(H_0\)</span> on the right side.</li>
<li>Second, we compute the left-tail area. These are the sample means that are more than 11 points from the hypothesized mean to the left <span class="math inline">\(P(\bar{X} &lt; 489) = P(Z &lt; -1.70) = 0.0446\)</span>.</li>
<li>Hence, the two-tailed p-value is 0.0892.</li>
</ul>
</div>
<p>Is the test significant at the 5% level? <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>Is it significant at the 1% level? <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>Researchers test whether <span class="math inline">\(\mu = 90\)</span>. They assume that <span class="math inline">\(\sigma=21\)</span>. The sample mean was 85. Sample size was 50.</p>
<p>What is the two-tailed p-value? <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer="[&quot;0.09&quot;,&quot;.09&quot;]"></p>
<p>What is the highest level at which the test is significant? <select class="webex-select"><option value="blank"></option>
<option value="">0.1</option>
<option value="">0.01</option>
<option value="answer">0.05</option>
<option value="">0.005</option></select></p>
<p>Researchers test whether <span class="math inline">\(\mu = 35\)</span>. They assume <span class="math inline">\(\sigma =16\)</span>. The sample mean was 38. Sample size was 64.</p>
<p>Compute the two-tailed p-value and indicate which of the following statements is true.</p>
<div id="radio_DYCRASFKVE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_DYCRASFKVE" value=""><span>The test is significant at the 10% level, but not at 5% or 1% level.</span></label><label><input type="radio" autocomplete="off" name="radio_DYCRASFKVE" value=""><span>The test is significant at the 10% and 5% level, but not at the 1% level.</span></label><label><input type="radio" autocomplete="off" name="radio_DYCRASFKVE" value=""><span>The test is significant at the 10%, 5% level, and 1% level.</span></label><label><input type="radio" autocomplete="off" name="radio_DYCRASFKVE" value="answer"><span>The test is not significant at 10%, not significant at 5% and not significant at 1%.</span></label>
</div>
<p>Consider these true- or false statements:</p>
<p>If a two-tailed p-value is .0567 then the test is significant at the 10% level but not at the 5% level. <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<p>If a two-tailed test is significant at the 5% level but not at the 1% level, then the two-tailed p-value will be less than 0.01. <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>A two-tailed p-value of 0.060 indicates that we have 6% chance that the null hypothesis is true. <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>


</section></section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./samplingdistribution.html" class="pagination-link" aria-label="The Sampling Distribution">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Sampling Distribution</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./glm1_regression.html" class="pagination-link" aria-label="GLM-I: Linear Regression">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">GLM-I: Linear Regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>CC-BY (2023) Caspar J. Van Lissa</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>