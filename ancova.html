<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Book Description">
<title>15&nbsp; GLM: ANCOVA – Statistics 1 and 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./rmanova.html" rel="next">
<link href="./factorial.html" rel="prev">
<link href="./images/logos/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
<link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/glossary.css">
<link rel="stylesheet" href="include/style.css">
<link rel="stylesheet" href="c:/gitbook_stats12/include/webex.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ancova.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">GLM: ANCOVA</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics 1 and 2</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/cjvanlissa/stats12" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Statistics-1-and-2.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Statistics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability Distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./samplingdistribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Sampling Distribution</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm1_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">GLM-I: Linear Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm2_sum_squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">GLM-II: Sums of Squares</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm3binary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">GLM-III: Binary Predictors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm4anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">GLM-IV: ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm5multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">GLM-V: Multiple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm6nested.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">GLM-VI: Nested models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm7interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">GLM-VII: Interaction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">GLM VIII - Logistic Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glm_contrasts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">GLM: Contrasts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./factorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">GLM: Factorial ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ancova.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">GLM: ANCOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rmanova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">GLM: Repeated Measures ANOVA</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reliability_validity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Reliability and Validity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Dimension Reduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confint.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">BE2 - Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data for Portfolio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Z-table</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formula_sheet2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Formula sheet</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#covariates-and-their-role" id="toc-covariates-and-their-role" class="nav-link active" data-scroll-target="#covariates-and-their-role"><span class="header-section-number">15.1</span> Covariates and Their Role</a></li>
  <li><a href="#good-neutral-and-bad-controls" id="toc-good-neutral-and-bad-controls" class="nav-link" data-scroll-target="#good-neutral-and-bad-controls"><span class="header-section-number">15.2</span> Good, Neutral, and Bad Controls</a></li>
  <li><a href="#calculating-adjusted-means" id="toc-calculating-adjusted-means" class="nav-link" data-scroll-target="#calculating-adjusted-means"><span class="header-section-number">15.3</span> Calculating Adjusted Means</a></li>
  <li><a href="#lecture" id="toc-lecture" class="nav-link" data-scroll-target="#lecture"><span class="header-section-number">16</span> Lecture</a></li>
  <li><a href="#formative-test" id="toc-formative-test" class="nav-link" data-scroll-target="#formative-test"><span class="header-section-number">17</span> Formative Test</a></li>
  <li>
<a href="#tutorial" id="toc-tutorial" class="nav-link" data-scroll-target="#tutorial"><span class="header-section-number">18</span> Tutorial</a>
  <ul class="collapse">
<li><a href="#bivariate-regression-recap" id="toc-bivariate-regression-recap" class="nav-link" data-scroll-target="#bivariate-regression-recap"><span class="header-section-number">18.1</span> Bivariate Regression (RECAP)</a></li>
  <li><a href="#anova-recap" id="toc-anova-recap" class="nav-link" data-scroll-target="#anova-recap"><span class="header-section-number">18.2</span> ANOVA (RECAP)</a></li>
  <li>
<a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova"><span class="header-section-number">18.3</span> ANCOVA</a>
  <ul class="collapse">
<li><a href="#assumption-or-not" id="toc-assumption-or-not" class="nav-link" data-scroll-target="#assumption-or-not"><span class="header-section-number">18.3.1</span> Assumption or not?</a></li>
  <li><a href="#back-to-ancova" id="toc-back-to-ancova" class="nav-link" data-scroll-target="#back-to-ancova"><span class="header-section-number">18.3.2</span> Back to ANCOVA</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-ancova" class="quarto-section-identifier"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">GLM: ANCOVA</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>ANCOVA, which stands for Analysis of Covariance, is an extension of the concepts we’ve covered in bivariate linear regression and multiple regression. It is essentially a multiple regression with a categorical predictor and one or more continuous predictors. What’s “special” about this technique is that it is commonly used when the predictor of interest is that categorical variable, and the continuous predictor(s) are so-called “covariates”: predictors that are only included to improve our estimate of the effect of the categorical predictor of interest.</p>
<p>You will often see this technique used to analyze data from experiments or “natural experiments”, where participants self-select into a treatment group.</p>
<p>While ANCOVA is a useful technique, it comes with some serious pitfalls: any time control variables are used, we are making assumptions about causality. If these assumptions are incorrect, our estimates of the effect of interest will be (severely) biased.</p>
<section id="covariates-and-their-role" class="level2" data-number="15.1"><h2 data-number="15.1" class="anchored" data-anchor-id="covariates-and-their-role">
<span class="header-section-number">15.1</span> Covariates and Their Role</h2>
<p>Covariates are variables that have a relationship with the dependent variable but are not the primary focus of the study. They are often referred to as control variables, as they help control for unwanted variability and improve the precision of the analysis. Examples of common covariates include age, gender, education level, or any other variables that might influence the dependent variable.</p>
<p>In terms of causality, it’s crucial to consider the relationships between covariates, predictors, and the outcome variable. Control variables should ideally be confounders – variables that influence both the predictor of interest and the outcome. It’s essential to avoid controlling for colliders, which are variables <em>caused by</em> both the predictor and the outcome. A thorough understanding of causal relationships is crucial for proper interpretation.</p>
<p>One reason why researchers use control variables in ANCOVA is because they reduce the residual variance in the outcome variable, which in turn increases the power to detect the effect of the predictor of interest. Another reason to use covariates is when the goal is making causal inferences, especially in quasi-experimental designs. The proper selection of covariates that enable causal inference requires careful consideration and is beyond the scope of this course.</p>
</section><section id="good-neutral-and-bad-controls" class="level2" data-number="15.2"><h2 data-number="15.2" class="anchored" data-anchor-id="good-neutral-and-bad-controls">
<span class="header-section-number">15.2</span> Good, Neutral, and Bad Controls</h2>
<p>Covariates fall into different categories based on their relationship with the predictor of interest and the outcome. An example of a good control is a confounder: a variable that causes both the predictor and the outcome. These need to be controlled to avoid spurious relationships. An example of a neutral control is a covariate that is unrelated to the predictor but can reduce error variance in the outcome, thereby increasing statistical power. Bad controls, on the other hand, can introduce biases, such as collider bias (controlling for an outcome of predictor and outcome), case control bias (controlling for an outcome of the outcome), or overcontrol bias (controlling for a mediator of the effect of the focal predictor on the outcome).</p>
<p>One crucial insight is that in randomized controlled experiments, the random assignment of participants to different groups breaks the relationship between confounders and the treatment variable. This makes control variables related to the confounders unnecessary. Controlling for them could even introduce bias into the analysis.</p>
</section><section id="calculating-adjusted-means" class="level2" data-number="15.3"><h2 data-number="15.3" class="anchored" data-anchor-id="calculating-adjusted-means">
<span class="header-section-number">15.3</span> Calculating Adjusted Means</h2>
<p>Adjusting for covariates involves calculating adjusted means – the means that groups would have had if they scored equally on the covariate. There are two ways to mathematically calculate the adjusted means. One way is to fill in the regression equation for the desired value of the covariate.</p>
<p>The other way is to calculate the adjusted means from the group means:</p>
<p><span class="math display">\[
\bar{Y}_g^{adj} = \bar{Y}_g - b(\bar{X}_g-\bar{X})
\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(\bar{Y}_g^{adj}\)</span>: Adjusted mean of the outcome for group g</li>
<li>
<span class="math inline">\(\bar{Y}_g\)</span>: Unadjusted mean of the outcome for group g</li>
<li>
<span class="math inline">\(b\)</span>: Regression coefficient of the covariate</li>
<li>
<span class="math inline">\(\bar{X}_g\)</span>: Group mean of covariate X</li>
<li>
<span class="math inline">\(\bar{X}\)</span>: Overall mean of covariate X</li>
</ul>
<p>In sum, ANCOVA is a different name for regression with a categorical predictor of interest, and continuous predictor(s) that are included to improve our estimate of the effect of the predictor of interest. ANCOVA can enhance statistical power and help make more accurate (potentiall causal) inferences. However, the careful selection of covariates and an understanding of causal relationships are paramount to its proper implementation and interpretation.</p>
</section><section id="lecture" class="level1" data-number="16"><h1 data-number="16">
<span class="header-section-number">16</span> Lecture</h1>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/MewqUBfQYok" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section><section id="formative-test" class="level1" data-number="17"><h1 data-number="17">
<span class="header-section-number">17</span> Formative Test</h1>
<p>A formative test helps you assess your progress in the course, and helps you address any blind spots in your understanding of the material. If you get a question wrong, you will receive a hint on how to improve your understanding of the material.</p>
<p>Complete the formative test ideally after you’ve seen the lecture, but before the lecture meeting in which we can discuss any topics that need more attention</p>
<div class="cell" data-layout-align="center">
<div class="webex-check webex-box">
<p><strong>Question 1</strong></p>
What is a valid reason for using covariates in ANCOVA?
<div id="radio_GQOYXTIHRN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GQOYXTIHRN" value="answer"><span>To increase statistical power</span></label><label><input type="radio" autocomplete="off" name="radio_GQOYXTIHRN" value=""><span>To create more complex models</span></label><label><input type="radio" autocomplete="off" name="radio_GQOYXTIHRN" value=""><span>To replace categorical predictors</span></label><label><input type="radio" autocomplete="off" name="radio_GQOYXTIHRN" value=""><span>To increase the total variance</span></label>
</div>
<p><strong>Question 2</strong></p>
What is an example of a ‘good control’ variable in ANCOVA?
<div id="radio_FITGAIEUCL" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FITGAIEUCL" value=""><span>A variable affected by the outcome</span></label><label><input type="radio" autocomplete="off" name="radio_FITGAIEUCL" value=""><span>A variable unrelated to the predictor</span></label><label><input type="radio" autocomplete="off" name="radio_FITGAIEUCL" value="answer"><span>A confounder</span></label><label><input type="radio" autocomplete="off" name="radio_FITGAIEUCL" value=""><span>A variable related to the predictor</span></label>
</div>
<p><strong>Question 3</strong></p>
Which of the following is an example of a ‘bad control’ variable in ANCOVA?
<div id="radio_QCRXYLQXTZ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QCRXYLQXTZ" value=""><span>A confounder</span></label><label><input type="radio" autocomplete="off" name="radio_QCRXYLQXTZ" value="answer"><span>A variable affected by the outcome</span></label><label><input type="radio" autocomplete="off" name="radio_QCRXYLQXTZ" value=""><span>A variable that causes the predictor</span></label><label><input type="radio" autocomplete="off" name="radio_QCRXYLQXTZ" value=""><span>A variable unrelated to the predictor or outcome</span></label>
</div>
<p><strong>Question 4</strong></p>
In a randomized controlled experiment, are there benefits to controling for any observed differences between the two experimental groups?
<div id="radio_KGKULPRDZN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KGKULPRDZN" value=""><span>Only if the covariates are significantly related to the outcome</span></label><label><input type="radio" autocomplete="off" name="radio_KGKULPRDZN" value=""><span>Yes, controlling for relevant covariates is essential</span></label><label><input type="radio" autocomplete="off" name="radio_KGKULPRDZN" value="answer"><span>No, random assignment breaks the predictor's relationships with confounders</span></label><label><input type="radio" autocomplete="off" name="radio_KGKULPRDZN" value=""><span>Only if the covariates are significantly related to the predictor</span></label>
</div>
<p><strong>Question 5</strong></p>
What is the purpose of calculating adjusted means in ANCOVA?
<div id="radio_NHSIRQJWEY" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_NHSIRQJWEY" value=""><span>To create new variables</span></label><label><input type="radio" autocomplete="off" name="radio_NHSIRQJWEY" value="answer"><span>To account for covariate effects</span></label><label><input type="radio" autocomplete="off" name="radio_NHSIRQJWEY" value=""><span>To replace the original means</span></label><label><input type="radio" autocomplete="off" name="radio_NHSIRQJWEY" value=""><span>To improve the model's fit</span></label>
</div>
<p><strong>Question 6</strong></p>
Which of the following is a key factor in choosing appropriate covariates for ANCOVA?
<div id="radio_KXQBWJJMNN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_KXQBWJJMNN" value=""><span>Number of covariates</span></label><label><input type="radio" autocomplete="off" name="radio_KXQBWJJMNN" value=""><span>Covariates with the highest correlations</span></label><label><input type="radio" autocomplete="off" name="radio_KXQBWJJMNN" value="answer"><span>Causal relationships</span></label><label><input type="radio" autocomplete="off" name="radio_KXQBWJJMNN" value=""><span>Covariates with the smallest p-values</span></label>
</div>
<p><strong>Question 7</strong></p>
What is the distinguishing feature of ANCOVA relative to multiple regression?
<div id="radio_OPQTJCMBAB" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_OPQTJCMBAB" value="answer"><span>ANCOVA always includes a categorical predictor and control variable(s)</span></label><label><input type="radio" autocomplete="off" name="radio_OPQTJCMBAB" value=""><span>Multiple regression includes only continuous predictors</span></label><label><input type="radio" autocomplete="off" name="radio_OPQTJCMBAB" value=""><span>Multiple regression includes only covariates</span></label><label><input type="radio" autocomplete="off" name="radio_OPQTJCMBAB" value=""><span>ANCOVA controls for confounding variables</span></label>
</div>
<p><strong>Question 8</strong></p>
In which of these situations should you avoid controlling a particular covariate in ANCOVA?
<div id="radio_DZQNUVRCGP" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_DZQNUVRCGP" value=""><span>When the covariate is irrelevant</span></label><label><input type="radio" autocomplete="off" name="radio_DZQNUVRCGP" value=""><span>When the covariate is perfectly correlated with another covariate</span></label><label><input type="radio" autocomplete="off" name="radio_DZQNUVRCGP" value="answer"><span>When the covariate is a mediator</span></label><label><input type="radio" autocomplete="off" name="radio_DZQNUVRCGP" value=""><span>When the covariate is a confounder</span></label>
</div>
<p><strong>Question 9</strong></p>
An ANCOVA model compares statistics grades for two classes of students, controlling for number of hours studied per week. The regression model is <span class="math inline">\(\text{Grade} = -1.27 + 0.50*D_{class2} + .30*Hours\)</span>. The unadjusted mean grades are 5.2 for class 1 and 7.3 for class 2. The mean hours studied were 21.56 for class 1 and 30.23 for class 2. The overall mean hours studied was 25.90. What are the adjusted means?
<div id="radio_BJZCNCNARE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_BJZCNCNARE" value=""><span>9.35 and 2.97</span></label><label><input type="radio" autocomplete="off" name="radio_BJZCNCNARE" value=""><span>-1.27 and -1.77</span></label><label><input type="radio" autocomplete="off" name="radio_BJZCNCNARE" value="answer"><span>6.50 and 6.00</span></label>
</div>
</div>
<div class="webex-solution">
<button>
Show explanations
</button>
<p><strong>Question 1</strong></p>
<p>Covariates can be used in ANCOVA to reduce error variance caused by factors other than the predictor of interest.</p>
<p><strong>Question 2</strong></p>
<p>A confounder is a ‘good control’ variable in ANCOVA – a variable that influences both the predictor of interest and the outcome.</p>
<p><strong>Question 3</strong></p>
<p>A variable that is affected by the outcome is a ‘bad control’ variable in ANCOVA and can introduce biases.</p>
<p><strong>Question 4</strong></p>
<p>In a randomized controlled experiment, random assignment breaks the relationships between confounders and the treatment. Therefore, controlling for covariates related to the predictor is unnecessary.</p>
<p><strong>Question 5</strong></p>
<p>Adjusted means in ANCOVA are controlled for the effects of covariates, allowing us to understand how groups would differ on the outcome variable if they had equal scores on the covariate.</p>
<p><strong>Question 6</strong></p>
<p>Causal relationships are crucial when selecting covariates for ANCOVA. It’s important to choose covariates that are related to the outcome and predictor in a meaningful way.</p>
<p><strong>Question 7</strong></p>
<p>ANCOVA is one example of the broader category of models known as multiple regression; it is characterized by having a categorical predictor of interest and (continuous) covariates.</p>
<p><strong>Question 8</strong></p>
<p>Avoid controlling for covariates that are mediators, as controlling for mediators could lead to overcontrol bias and distort the relationships between the predictor and outcome.</p>
<p><strong>Question 9</strong></p>
<p>Use the formula <span class="math inline">\(\bar{Y}_g^{adj} = \bar{Y}_g - b(\bar{X}_g-\bar{X})\)</span></p>
</div>
</div>
</section><section id="tutorial" class="level1" data-number="18"><h1 data-number="18">
<span class="header-section-number">18</span> Tutorial</h1>
<section id="bivariate-regression-recap" class="level2" data-number="18.1"><h2 data-number="18.1" class="anchored" data-anchor-id="bivariate-regression-recap">
<span class="header-section-number">18.1</span> Bivariate Regression (RECAP)</h2>
<p>Researchers are interested in the relationship between age and depression.</p>
<p>They hypothesized that older people are more vulnerable to depressive thoughts than younger people.</p>
<p>To test their research hypothesis, they collected data in a random sample of 164 persons from the general population. Open the dataset <code>HADShealthyGroup.sav</code>.</p>
<p>Run a linear regression analysis using age as the independent variable and depression as the dependent variable.</p>
<p>Proceed as follows:</p>
<p>Navigate to Analyze &gt; Regression &gt; Linear</p>
<p>Select the correct dependent and independent variable.</p>
<p>Paste and run the syntax.</p>
<p>How much of the total variance in Depression is explained by Age? <input class="webex-solveme nospaces" data-tol="0.005" size="4" data-answer="[&quot;0.02&quot;,&quot;.02&quot;]"></p>
<p>What can you say about the effect size? Would you say it’s a lot?</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>To me, 2% of explained variance does not seem like a lot. There are probably better predictors of depression (i.e., predictors that explain more of the variance in depression).</p>
</div>
<p>True or false: The explained variance is significant at the 10% level. <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<div class="webex-solution">
<button>
Answer
</button>
<p>To conclude anything about the significance of the proportion explain variance of this model, we can look at the ANOVA table or ask SPSS to show the R2-change. This shows us that the explained variance in this model is not significant compared to an empty model (i.e.&nbsp;including no predictors), F(1,140) = 2.836, p = .094.</p>
</div>
<p>Write down the estimated regression line using the unstandardized coefficients.</p>
<p>Y’= <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer="[&quot;1.89&quot;]"> + <input class="webex-solveme nospaces" data-tol="0.005" size="4" data-answer="[&quot;0.02&quot;,&quot;.02&quot;]"> *Age</p>
<p>How can we interpret the constant?</p>
<div id="radio_QEXTNXZJCE" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_QEXTNXZJCE" value=""><span>The predicted level of depression for the average age.</span></label><label><input type="radio" autocomplete="off" name="radio_QEXTNXZJCE" value=""><span>The average age in the sample.</span></label><label><input type="radio" autocomplete="off" name="radio_QEXTNXZJCE" value="answer"><span>The predicted level of depression when age would be 0.</span></label><label><input type="radio" autocomplete="off" name="radio_QEXTNXZJCE" value=""><span>The average level of depression.</span></label>
</div>
<p>Consult the table with the coefficients again</p>
<p>True or false: We can conclude from this table that the effect of age is significant at the 10% level. <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<div class="webex-solution">
<button>
Answer
</button>
<p>To conclude whether the effect of Age on Depression is significant, we look at the t-test for the estimated coefficient.</p>
<p>We should conclude that the effect of Age on Depression is significant when using <span class="math inline">\(\alpha\)</span>=.10, t(140) = 1.684, p = .094.</p>
</div>
<p>One of the assumptions of bivariate regression analysis is that the relationship between the independent and dependent variable is linear.</p>
<p>State in your own words what this assumption entails.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The assumption of a linear relationship entails that the relationship between the variables can be described with a straight line.</p>
</div>
<p>How would you evaluate the assumption of linearity graphically? Do it for the data at hand.</p>
<p>True or false: The relationship is linear. <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>If the assumption is not met, speculate about other possible relationships between age and depression.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The scatter plot does not have the shape of a cigar, so it does not unambiguously suggest a linear relationship. Thus, you may doubt whether the relationship between age and depression is best described by a linear model. Perhaps the relationship is quadratic. Especially persons in middle ages may be vulnerable to depressive thoughts. Next to the plot, you find both the estimated linear trend and a non-linear trend. It seems that the quadratic curve fits better with the data. Moreover, the quadratic model explains 6% of the variance, whereas the linear model only 2%.</p>
</div>
<p>Run a regression analysis using Age as the independent variable and Anxiety as the dependent variable.</p>
<p>Summarize the results.</p>
<p>Include in your answer the proportion of explained variance (R-square), a description of the effect based on the estimated regression coefficients, and evaluate the significance of the effect of age on anxiety.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The proportion explained variance in Anxiety by Age is .071. The explained variance in this model is not significant compared to an empty model (i.e.&nbsp;including no predictors), F(1,140) = 0.710, p = .401.</p>
<p>The effect is Age on Anxiety is negative (<span class="math inline">\(\beta\)</span> = -0.013), meaning that anxiety decreases with age. However, the effect of Age on Anxiety is not significant when using <span class="math inline">\(\alpha\)</span>=.05, t(140) = -0.842, p = .401.</p>
</div>
</section><section id="anova-recap" class="level2" data-number="18.2"><h2 data-number="18.2" class="anchored" data-anchor-id="anova-recap">
<span class="header-section-number">18.2</span> ANOVA (RECAP)</h2>
<p>Consider the following hypothetical research situation…</p>
<p>Researchers are interested in effects of stereotyping on cognitive performance. For their research they performed a quasi-experiment. They selected three schools and asked girls from eight grade to do a math test. However, the teacher in School A says that boys do particularly well on the test (i.e., negative stereotyping for girls). In School B the teachers says that girls do particularly well on the test (i.e., positive stereotyping for girls). In the third school, the teacher gives gender-neutral information (control group).</p>
<p>Afterwards the researchers compare the average math grades across the three groups. Because the schools may also differ in the student population, researchers also measured scholastic aptitude and use that as a covariate in the analysis.</p>
<p>Open the dataset <code>stereotyping.sav</code>.</p>
<p>In your own words, explain what a covariate is and give two examples of covariates that should/can be included in neuro-psychological research.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>Covariates are “nuissance” variables that we are not directly interested in, but that allow us to better estimate the effect of another variable of interest.</p>
<p>This is related to causal inference.</p>
<p>We must thus justify our covariates by reference to their putative causal role with relation to our predictor and outcome.</p>
<p>A covariate that <em>causes</em> both our predictor and our outcome is a <em>confounder</em>, and should be controlled for. This sometimes happens in “natural experiments”, where the factor is not randomly assigned to participants.</p>
<p>A covariate that <em>causes</em> our outcome, but is unrelated to our predictor, can be controlled for to reduce error variance in the outcome and increase statistical power of the effect of interest. This typically happens in randomized controlled experiments, but it may also happen in natural experiments.</p>
<p>As a counter-example: A variable that <em>is caused by</em> our predictor and our outcome is a collider, and should never be controlled for! This will bias the effect of our predictor.</p>
</div>
<p>Mention two often-used covariates in research.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>Gender and Age are two covariates that are often used in research.</p>
</div>
<p>Let’s start analyzing the math scores using an ANOVA, thus ignoring any covariates for now.</p>
<ul>
<li>Compute the means across the three groups (Analyze à Compare means à Means.</li>
<li>Select MATH for the dependent list and STEREO as the independent.</li>
<li>Paste and run the syntax.</li>
<li>Inspect the table that displays the mean differences between the groups.</li>
</ul>
<p>What is the first impression of stereotyping that we have from the mean differences?</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The table shows that no stereotyping results in the lowest mean score on the math test. Positive stereotyping results in the highest mean score, and negative stereotyping is in between.</p>
</div>
<p>Run an ANOVA: (Analyze -&gt; general linear model -&gt; univariate). Select MATH as the dependent variable and STEREO as fixed factor.</p>
<p>Write down the null and alternative hypothesis of the ANOVA, then check your answer.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>H0: <span class="math inline">\(\mu1 = \mu2 = \mu3\)</span> H1: not <span class="math inline">\(\mu1 = \mu2 = \mu3\)</span></p>
</div>
<p>True or false: The effect of stereotyping is significant (use <span class="math inline">\(\alpha\)</span>=0.05). <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<div class="webex-solution">
<button>
Answer
</button>
<p>Yes, the F-test for the effect of Stereotyping on Math performance is significant, F(2,27) = 5.614, p = .009. Hence, we reject H0.</p>
<p>We have convincing evidence that, also at the population level, the means differ.</p>
<p>In other words, we have convincing evidence that the mean differences in math performance are not the result of sampling fluctuations but reflect true differences due to the manipulation (i.e.&nbsp;stereotyping).</p>
</div>
<p>How large is the R-square? <input class="webex-solveme nospaces" data-tol="0.01" size="5" data-answer="[&quot;0.294&quot;,&quot;.294&quot;]"></p>
<p>How do you interpretat this value of the R-square?</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The R2 is 0.294.</p>
<p>This means that 29.4% of the variance in Math performance is explained by the Stereotyping.</p>
</div>
<p>The R-square should be equal to:</p>
<div id="radio_SEWPXEHLPN" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_SEWPXEHLPN" value="answer"><span>The ratio of the sum of squares for STEREO to the (corrected) total sum of squares.</span></label><label><input type="radio" autocomplete="off" name="radio_SEWPXEHLPN" value=""><span>The ratio of the mean square for STEREO to the (corrected) total mean square.</span></label><label><input type="radio" autocomplete="off" name="radio_SEWPXEHLPN" value=""><span>The ratio of the sum of squares for STEREO to the error sum of squares.</span></label><label><input type="radio" autocomplete="off" name="radio_SEWPXEHLPN" value=""><span>The ratio of the mean square for STEREO to the error mean square.</span></label>
</div>
<p>Test whether there is an effect of stereotyping (regardless of whether it is positive or negative stereotyping).</p>
<p>True or false: The effect of stereotyping (regardless of whether it is positive or negative stereotyping) is significant. <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<p>Report Levene’s test, significance of the contrast that you tested, and an interpretation of the difference between the two means.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The Levene’s test is not significant (p = .805), so there is no evidence for violation of the assumption of homoscedasticity.</p>
</div>
<p>Test the mean math score for each experimental group against the control group; that is, you have to test two planned contrasts.</p>
<p>Are the means different when tested at an experiment-wise alpha of .05 and using a Bonferroni corrected alpha per test? Substantiate your answer.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The contrast is significant at <span class="math inline">\(\alpha\)</span> = .05.</p>
<p>These results suggest that stereotyping (positive/negative) results in better math performance than non-stereotyping.</p>
</div>
</section><section id="ancova" class="level2" data-number="18.3"><h2 data-number="18.3" class="anchored" data-anchor-id="ancova">
<span class="header-section-number">18.3</span> ANCOVA</h2>
<p>The next step is to add scholastic aptitude as a covariate in our analysis.</p>
<p>In the lecture, we considered two situations in which ANCOVA is used; one in which the covariate was not related to the grouping variable, and one in which the covariate is associated.</p>
<p>Which situation do we have in this study? To answer the question, you need to ask for some additional statistics in SPSS.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>We can check if the covariate is associated with the experimental factor by inspecting the means of the experimental groups on the covariate, or by running a one-way ANOVA.</p>
<p>The covariate is associated with the grouping variable, and thus mean differences in math between the three groups may be confounded by mean differences in scholastic aptitude between the three groups.</p>
</div>
<section id="assumption-or-not" class="level3" data-number="18.3.1"><h3 data-number="18.3.1" class="anchored" data-anchor-id="assumption-or-not">
<span class="header-section-number">18.3.1</span> Assumption or not?</h3>
<p>Some texts state that ANCOVA has an additional assumption, beyond those of multiple regression. This “extra assumption” is the assumption of “homogeneity in regression slopes”.</p>
<p>The assumption of homogeneity in regression slopes states that the within-group effect of the covariate is the same across groups. That is, the covariate does not interact with the grouping variable.</p>
<p>For example, in this assignment, the assumption would imply that the effect of scholastic aptitude is independent of the experimental condition.</p>
<p>But: ANCOVA is just a special name for multiple regression with a categorical predictor of interest and control variables that we’re not interested in (“nuissance variables”). If ANCOVA is multiple regression, then how can it have differen assumptions than multiple regression?</p>
<p>The answer is that ANCOVA does <strong>not</strong> have different assumptions, but if we were to allow for interaction between the factor and covariate, we would simply no longer call the resulting model an ANCOVA.</p>
<p>So instead of saying “ANCOVA has an assumption of homogeneity in regression slopes”, we could say: “it is conventional to call a model ANCOVA if it contains a factor and some control variables, but no interaction”. Of course we can add interaction terms in such a model - but then we just call it multiple regression with an interaction, not ANCOVA.</p>
<p>Omitting an interaction between the factor and the covariate means that we force the within-group effect of the covariate to be the same across levels of the factor. In this study, that means that we do not allow the effect of scholastic aptitude to depend on the experimental condition.</p>
<p>Before we carry out the actual ANCOVA, we can check whether this model is correctly specified, or whether we are missing a significant interaction. We can check whether there is a significant interaction effect using the following syntax:</p>
<pre><code>    UNIANOVA SA BY STEREO WITH MATH
      /METHOD=SSTYPE(3)
      /INTERCEPT=INCLUDE
      /PRINT=DESCRIPTIVE PARAMETER HOMOGENEITY
      /CRITERIA=ALPHA(.05)
      /DESIGN=STEREO MATH MATH*STEREO.</code></pre>
<p>Copy and run the syntax. Go to the table “Tests of Between-Subjects Effects”. Take a look at the row STEREO*MATH.</p>
<p>True or false: There is a significant interaction effect. <select class="webex-select"><option value="blank"></option>
<option value="NA">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>If there is a significant interaction effect, what do we do?</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>Remember we can check for a significant interaction effect for two reasons:</p>
<ol type="1">
<li>Our hypothesis is about the interaction effect</li>
<li>As an assumption check for correct model specification (i.e., we’re interested in main effects, but we want to make sure that we’re not ignoring an interaction when we do). This is similar to checking for linearity.</li>
</ol>
<p>In the first case, we should not be conducting ANCOVA at all; we should start with multiple regression with interaction, because the interaction effect is our effect of interest.</p>
<p>In the second case, we can do two things: We can change our analysis based on the results of the “assumption check” - but such data-dependent decisions increase the risk of overfitting and Type I errors. Alternatively, we can just report the results of our planned ANCOVA analysis, but mention in the discussion that we observed a significant interaction, which means that the model may have been misspecified. We can also report results from both models, and see if/how the conclusions change if we allow for interaction (this is called a <em>sensitivity analysis</em>).</p>
</div>
</section><section id="back-to-ancova" class="level3" data-number="18.3.2"><h3 data-number="18.3.2" class="anchored" data-anchor-id="back-to-ancova">
<span class="header-section-number">18.3.2</span> Back to ANCOVA</h3>
<p>Let’s run an ANCOVA, proceed as follows:</p>
<ul>
<li>Navigate to Analyze &gt; General linear model ? Univariate</li>
<li>Select MATH as the dependent variable, STEREO as fixed factor, and SA as the covariate.</li>
<li>Also, via OPTIONS ask for the Parameter estimates. Paste and run the syntax.</li>
</ul>
<p>Consider the Tests of Between Subjects Effects table (henceforth referred to as the “ANCOVA table”) and the FF-test for the grouping factor (STEREO).</p>
<p>What’s the p-value for the overall test of model fit? <input class="webex-solveme nospaces" data-tol="0.01" size="5" data-answer="[&quot;0.117&quot;,&quot;.117&quot;]"></p>
<p>What conclusions can be drawn from the F-test?</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The F-test is a test of the effect of Stereotyping on Math performance controlled for Scholastic aptitude. Conceptually, it tests whether differences in the adjusted means in Math performance are significant. Adjusted means are the means we would expect if the group had an average level of Scholastic aptitude.</p>
<p>In other words, it tests the differences in the hypothetical situation we would have had three groups that had exactly the same level of Scholastic aptitude.</p>
<p>The F-test is not significant, F(2,26) = 2.333, p = .117, which means that, controlled for Scholastic aptitude, we don’t have convincing evidence that Stereotyping had an effect on Match performance.</p>
</div>
<p>Compare the results ANOVA and ANCOVA. What important difference do we see and how would you explain those?</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The ANOVA suggested a significant effect, whereas once controlled for Scholastic aptitude (ANCOVA) the effect was no longer significant.</p>
<p>Thus, the mean differences between the experimental groups we saw before were indeed confounded with differences in Scholastic aptitude!</p>
</div>
<p>Consult the table parameter estimates.</p>
<p>What is the regression slope for scholastic aptitude? <input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer="[&quot;0.47&quot;,&quot;.47&quot;]"></p>
<p>Explain the meaning of estimated parameter for scholastic aptitude.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The parameter estimate for Scholastic aptitude is 0.470. The effect is significant when using <span class="math inline">\(\alpha\)</span> = .05.</p>
<p>It is the pooled within-group regression effect of Scholastic aptitude on Math performance, controlled for Stereotyping.</p>
<p>Thus, if Scholastic aptitude increases by one unit, the predicted Math score increases by .470 units, while controlling for Stereotyping.</p>
</div>
<p>Based on the Parameters Estimates and the group-specific means, compute the adjusted group means (for each of the groups!) on MATH for an average scholastic aptitude.</p>
<p>What is the adjusted group mean for the group that received the Negative Stereotype manipulation? <input class="webex-solveme nospaces" data-tol="0.01" size="5" data-answer="[&quot;6.359&quot;]"></p>
<p><span class="math inline">\(\bar{Y}_k^{adj} = \bar{Y}_k -b_w(\bar{X}_k- \bar{X})\)</span></p>
<p>To use the formula, you need to know the group means on MATH (you computed them before), you have to know the group means and overall mean SA (you can compute them via means), and the regression effect which is given in the table with parameter estimates.</p>
<p>Check your adjusted means against this answer model:</p>
<div class="webex-solution">
<button>
Answer
</button>
<p><img src="images/Figure13-1.png" class="img-fluid"></p>
</div>
<p>Rerun the ANCOVA. Now via OPTIONS also ask for the estimated means. You do so by selecting stereo in the list of Display Means for (at the top of the menu). Look in the table Estimated Marginal Means and verify your answer to the previous question.</p>
<p>Write down in your own words – and as precise as possible – the meaning of adjusted means.</p>
<div class="webex-solution">
<button>
Answer
</button>
<p>The estimated marginal means (i.e., the adjusted means) are the group means if all groups would’ve had an average of 6.20 on the covariate.</p>
</div>
<p>Finally, we want to look at several effect size estimates.</p>
<p>How much of the variance in Math do SA and STEREO explain? <input class="webex-solveme nospaces" data-tol="0.01" size="5" data-answer="[&quot;0.421&quot;,&quot;.421&quot;]"></p>
<p>Controlled for SA, how much of the remaining variance in Math does STEREO explain? Use the formula mentioned in the lecture slides to calculate the partial <span class="math inline">\(\eta^2\)</span>: <input class="webex-solveme nospaces" data-tol="0.01" size="5" data-answer="[&quot;0.152&quot;,&quot;.152&quot;]"></p>
<p>Verify your answer by running the ANCOVA again. Now, in options, select the box Estimates if effect size.</p>
<p>True or false: SPSS reports the same partial η2. <select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="NA">FALSE</option></select></p>
<p>Could you summarize your findings of the ANCOVA in a few brief sentences?</p>
<p>Mention the significance tests, (un)adjusted means and the effect size estimates.</p>


</section></section></section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./factorial.html" class="pagination-link" aria-label="GLM: Factorial ANOVA">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">GLM: Factorial ANOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./rmanova.html" class="pagination-link" aria-label="GLM: Repeated Measures ANOVA">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">GLM: Repeated Measures ANOVA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>CC-BY (2023) Caspar J. Van Lissa</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>