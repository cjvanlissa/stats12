<!DOCTYPE html>
<html lang="en"><head>
<script src="lecture6_sums_squares_files/libs/clipboard/clipboard.min.js"></script>
<script src="lecture6_sums_squares_files/libs/quarto-html/tabby.min.js"></script>
<script src="lecture6_sums_squares_files/libs/quarto-html/popper.min.js"></script>
<script src="lecture6_sums_squares_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="lecture6_sums_squares_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lecture6_sums_squares_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="lecture6_sums_squares_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="lecture6_sums_squares_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.427">

  <meta name="author" content="Caspar J. van Lissa">
  <meta name="dcterms.date" content="2023-08-17">
  <title>Lecture 6 - GLM II</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="lecture6_sums_squares_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="lecture6_sums_squares_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="lecture6_sums_squares_files/libs/revealjs/dist/theme/quarto.css">
  <link href="lecture6_sums_squares_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="lecture6_sums_squares_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="lecture6_sums_squares_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="lecture6_sums_squares_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Lecture 6 - GLM II</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Caspar J. van Lissa 
</div>
</div>
</div>

  <p class="date">2023-08-17</p>
</section>
<section class="slide level2">

<!-- GLM II: Sums of squares, explained variance, and correlation -->
</section>
<section>
<section id="sums-of-squares" class="title-slide slide level1 center">
<h1>Sums of Squares</h1>

</section>
<section id="prediction-error" class="slide level2 smaller">
<h2>Prediction error</h2>
<p>Last week, we discussed linear regression</p>
<ul>
<li>It describes the relationship between a predictor X and outcome Y as a diagonal line</li>
<li>Given individual value <span class="math inline">\(X_i\)</span>, this line predicts a value <span class="math inline">\(\hat{Y}_i\)</span></li>
<li>This prediction will be a bit wrong for every individual</li>
<li>The regression line, by definition, is the line that gives the “least prediction error” on average</li>
<li>Today, we will learn how that is determined</li>
</ul>

<img data-src="lecture6_sums_squares_files/figure-revealjs/unnamed-chunk-2-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="ordinary-least-squares" class="slide level2 smaller">
<h2>Ordinary least squares</h2>
<p>Linear regression models are estimated using the “ordinary least squares” method</p>
<ul>
<li>It minimizes the total prediction error</li>
<li>So what is this “total prediction error”? Let’s define it</li>
</ul>
<p>Can we simply add the prediction errors for the 92 students below?</p>

<img data-src="lecture6_sums_squares_files/figure-revealjs/unnamed-chunk-3-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="sum-of-squared-errors" class="slide level2">
<h2>Sum of Squared Errors</h2>
<p><strong>Problem:</strong> Because the regression line, by definition, goes exactly through the “middle” of the data, the sum of all prediction errors is always exactly 0</p>
<p>Sum of <font color="blue">positive</font> prediction errors: 36.25</p>
<p>Sum of prediction errors: -36.25</p>

<img data-src="lecture6_sums_squares_files/figure-revealjs/unnamed-chunk-4-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="sum-of-squared-errors-sse" class="slide level2">
<h2>Sum of Squared Errors (SSE)</h2>
<p>The positive errors are exactly negated by the negative errors</p>
<p><strong>Solution:</strong> We take the <strong>square</strong> of the prediction errors to get rid of the negatives</p>
<ul>
<li>This allows us to take a sum of squared errors; this is always a positive number</li>
<li>We can then find the regression line that gives the smallest “sum of squared errors”</li>
<li>That regression line also gives the smallest (non-squared) errors, so squaring them doesn’t affect our results</li>
</ul>
</section>
<section id="sum-of-squared-errors-1" class="slide level2">
<h2>Sum of Squared Errors</h2>
<p>Sum of Squared Prediction Errors (= Sum of Squared Errors, SSE):</p>
<p><span class="math display">\[
\sum{(Y_i - \hat{Y}_i)^2} = 84.18
\]</span></p>
<p>This is the first example of a <strong>sum of squares</strong>. You will see many more, whenever we’re summing things that can be both positive and negative, and the formula usually looks like:</p>
<p><span class="math display">\[
\sum(\dots-\dots)^2
\]</span></p>
</section>
<section id="ordinary-least-squares-1" class="slide level2">
<h2>Ordinary Least Squares</h2>
<p>For linear regression, the coefficients can be calculated straightforwardly using matrix algebra (not part of this course)</p>
<ul>
<li>This calculation gives, by definition, the line with the <strong>smallest possible</strong> total prediction error</li>
<li>Prediction error is defined as “sum of squared errors”</li>
<li>Therefore, this method is called “ordinary least squares” (= squared errors)</li>
</ul>
</section>
<section id="goodness-of-fit" class="slide level2">
<h2>Goodness of fit</h2>
<p>By definition, the regression line is the line that best describes the data</p>
<ul>
<li>But how well does it describe the data?</li>
<li>In a way, the SSE describes the goodness of fit: small prediction errors imply good fit</li>
<li>But SSE is not on a meaningful scale, so we cannot interpret it easily</li>
</ul>
<p><strong>Solution:</strong> We need to compare the SSE to some baseline</p>
</section>
<section id="null-model" class="slide level2">
<h2>Null model</h2>
<p>To determine the goodness of fit of our regression line, we compare its SSE to the sum of squares we would obtain if we did not use information from the predictor to predict our outcome</p>
<ul>
<li>If you did not include Hours as a predictor, you would predict the mean for each individual</li>
<li>A regression model without predictors is simply:
<ul>
<li><span class="math inline">\(Y_i = a + e_i\)</span>, where <span class="math inline">\(e_i \sim N(0, SD_y)\)</span></li>
<li>This is called a “null model” (no predictors)</li>
<li>Its only coefficient <span class="math inline">\(a\)</span> is just the mean of <span class="math inline">\(Y\)</span></li>
</ul></li>
</ul>
</section>
<section id="total-sum-of-squares" class="slide level2">
<h2>Total Sum of Squares</h2>
<p>You would predict the mean value of Grade for each individual, <span class="math inline">\(\bar{Y}\)</span></p>
<p>The sum of squared distances between the mean and individual observations is called <font color="blue">Total Sum of Squares</font>, TSS: <span class="math inline">\(\sum{(Y_i-\bar{Y}_i)^2} = 255.82\)</span></p>

<img data-src="lecture6_sums_squares_files/figure-revealjs/unnamed-chunk-5-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="tss-is-related-to-the-variance" class="slide level2">
<h2>TSS is related to the variance</h2>
<p>You’ve seen the TSS before; it is used to calculate the variance (lecture 1)</p>
<ul>
<li><span class="math inline">\(S_Y^2 = \frac{\sum(Y_i-\bar{Y})^2}{n-1}\)</span></li>
<li>This is the “average” squared distance of individual observations to the mean of Y</li>
</ul>

<img data-src="lecture6_sums_squares_files/figure-revealjs/unnamed-chunk-6-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="regression-sum-of-squares" class="slide level2 smaller">
<h2>Regression Sum of Squares</h2>
<p>How large is the difference between the total sum of squares and the sum of squared errors?</p>
<ul>
<li>In other words: how much of the total sum of squares is explained away by the regression line?</li>
</ul>
<p>The reduction in sum of squares that occurs by using the regression line to predict observations instead of just the mean is called <font color="blue">Regression Sum of Squares</font>, RSS:</p>
<p>It’s the difference between individual predctions and the mean:</p>
<p><span class="math display">\[
\sum{(\hat{Y}_i-\bar{Y})^2}
\]</span></p>
<p>So it follows: Total SS - Error SS = Regression SS</p>
<p>255.82 - 84.18 = 171.64</p>
</section>
<section id="sum-of-squares-demo" class="slide level2">
<h2>Sum of Squares demo</h2>
<p><a href="https://utrecht-university.shinyapps.io/cj_regression_residuals/">See this demo (LINK)</a></p>
</section>
<section id="section" class="slide level2" data-background-iframe="https://utrecht-university.shinyapps.io/cj_regression_residuals/">
<h2></h2>
</section>
<section id="sums-of-squares-formulas" class="slide level2">
<h2>Sums of Squares formulas</h2>
<table>
<thead>
<tr class="header">
<th>Sum</th>
<th>Formula</th>
<th>Also</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SSE</td>
<td><span class="math inline">\(\sum{(Y_i - \hat{Y}_i)^2}\)</span></td>
<td>SST - SSR</td>
</tr>
<tr class="even">
<td>SST</td>
<td><span class="math inline">\(\sum{(Y_i - \bar{Y})^2}\)</span></td>
<td>SSR + SSE</td>
</tr>
<tr class="odd">
<td>SSR</td>
<td><span class="math inline">\(\sum{(\hat{Y}_i - \bar{Y})^2}\)</span></td>
<td>SST-SSE</td>
</tr>
</tbody>
</table>
</section></section>
<section>
<section id="explained-variance" class="title-slide slide level1 center">
<h1>Explained variance</h1>

</section>
<section id="model-fit" class="slide level2">
<h2>Model fit</h2>
<p>We want to describe how well our regression model describes the data</p>
<ul>
<li>Can we use the RSS?</li>
</ul>
<p><strong>Problem:</strong> Sums of squares are hard to interpret and cannot be compared from one dataset to another</p>
<ul>
<li>Adding even one participant increases the SS, but does not mean the fit is worse</li>
</ul>
<p><font color="blue">Solution:</font> We standardize the RSS</p>
</section>
<section id="explained-variance-1" class="slide level2">
<h2>Explained variance</h2>
<p>Which portion of the total sum of squares (TSS) is explained by the regression line (RSS)?</p>
<p><span class="math inline">\(\frac{RSS}{TSS} = R^2\)</span></p>
<p>This gives <span class="math inline">\(R^2\)</span>, the proportion of <strong>explained variance</strong></p>
</section>
<section id="explained-variance-2" class="slide level2">
<h2>Explained variance</h2>
<p>Which portion of the total variance in the dependent variable is explained by the predictor?</p>
<p>(see demo)</p>
<p>In our running example:</p>
<p><span class="math inline">\(\frac{171.64}{255.82} = 0.67\)</span></p>
</section></section>
<section>
<section id="tests" class="title-slide slide level1 center">
<h1>Tests</h1>

</section>
<section id="model-test" class="slide level2">
<h2>Model test</h2>
<p>Does the regression model explain significantly more variance than the null-model?</p>
<p>Remember:</p>
<ul>
<li>Regression model: <span class="math inline">\(Y_i = a + b * X_i + e_i\)</span></li>
<li>Null model: <span class="math inline">\(Y_i = a + e_i\)</span> (where <span class="math inline">\(a\)</span> is just the mean of <span class="math inline">\(Y\)</span>)</li>
</ul>
</section>
<section id="steps-for-testing" class="slide level2">
<h2>Steps for testing</h2>
</section>
<section id="steps-for-testing-1" class="slide level2 smaller">
<h2>Steps for testing</h2>
<ol type="1">
<li>Formulate hypotheses
<ul>
<li><span class="math inline">\(H_0\)</span>: <span class="math inline">\(R^2 = 0\)</span>, <span class="math inline">\(H_A\)</span>: <span class="math inline">\(R^2 &gt; 0\)</span></li>
</ul></li>
<li>Calculate test statistic</li>
</ol>
<p><strong>NOTE:</strong> <span class="math inline">\(R^2\)</span> only takes positive values, so we need a probability distribution that only takes positive values. That’s neither the Z- nor the t-distribution.</p>
</section>
<section id="f-test" class="slide level2">
<h2>F-test</h2>
<!--     + <font color = "gray">Describes how many standard errors away from the population statistic under the null hypothesis the sample statistic is</font> -->
<!-- 3. Calculate p-value -->
<!--     + <font color = "gray">Probability of observing a value at least as extreme as the sample statistic, if $H_0$ were true</font> -->
<!-- 4.  Draw conclusion about null hypothesis -->
<!--     + <font color = "gray">(Act as if) we reject or fail to reject it</font> -->
<p>Introducing the F-distribution</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="lecture6_sums_squares_files/figure-revealjs/unnamed-chunk-7-1.png" width="600" height="450"></p>
</figure>
</div>
</div>
</div>
<!--$F = \frac{MEAN of Squares Segression}{MEAN of Squares Error} = \frac{SSR/k}{SSE/(n-k)}$

$df_1$: k
$df_2$: n-k-->
</section>
<section id="f-test-1" class="slide level2">
<h2>F-test</h2>
<p>The F-test is a ratio of two sources of variance:</p>
<p><span class="math display">\[
F = \frac{\sigma^2_{\text{regression}}}{\sigma^2_{\text{Error}}} =  \frac{MS_{\text{regression}}}{MS_{\text{Error}}} = \frac{SSR/(p-1)}{SSE/(n-p)}
\]</span></p>
<p>p: parameters (<span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>), n: number of participants</p>
<ul>
<li><span class="math inline">\(df_1\)</span>: p-1</li>
<li><span class="math inline">\(df_2\)</span>: n-p</li>
</ul>
<p>Both SS can only be positive, so the F-statistic is always positive, so we use a probability distribution with only positive values.</p>
</section>
<section id="reporting-results" class="slide level2">
<h2>Reporting results</h2>
<p>The regression model explained significant variance in the outcome, <span class="math inline">\(R^2 = 0.67, F(1, 90) = 183.51, p &lt; .001.\)</span> This means that hours studied explained 0.67*100% of the variance in exam grades.</p>
<!--0$.-->
</section></section>
<section>
<section id="correlation" class="title-slide slide level1 center">
<h1>Correlation</h1>

</section>
<section id="correlation-and-regression" class="slide level2">
<h2>Correlation and regression</h2>
<p>Consider the association between X and Y</p>
<ul>
<li>If you consider one of them to be the outcome of the other, regression is the correct technique
<ul>
<li><span class="math inline">\(R^2\)</span> indicates the strength of association between them</li>
</ul></li>
<li>What if you don’t want to label one variable outcome and the other predictor?</li>
</ul>
<p>Correlation is a measure of the strength and direction of the linear relationship between two variables.</p>
</section>
<section id="correlation-1" class="slide level2">
<h2>Correlation</h2>
<p>A standardized measure of the strength of linear association between two continuous variables</p>
<ul>
<li>Standardized: ranges from [-1, 1]</li>
<li>Sample correlation: <span class="math inline">\(r\)</span></li>
<li>Population correlation: <span class="math inline">\(\rho\)</span></li>
<li>r = -1: Perfect negative association</li>
<li>r = 0: No association</li>
<li>r = 1: Perfect positive association</li>
</ul>
</section>
<section id="correlation-and-regression-1" class="slide level2">
<h2>Correlation and regression</h2>
<p>Correlation and regression are very closely related</p>
<ul>
<li><span class="math inline">\(R^2\)</span> (explained variance) for two is literally <span class="math inline">\(r\)</span>, squared: the squared correlation coefficient
<ul>
<li>For bivariate regression/correlation. The story is more complex for regression with 2+ predictors</li>
</ul></li>
</ul>
</section>
<section id="output-in-spss" class="slide level2">
<h2>Output in SPSS</h2>

<img data-src="images/regression_correlation.png" class="r-stretch"></section>
<section id="correlation-2" class="slide level2">
<h2>Correlation</h2>
<p>Correlation increases as:</p>
<ul>
<li>The points are closer to the regression line</li>
<li>The slope is steeper (whether positive or negative)</li>
</ul>

<img data-src="lecture6_sums_squares_files/figure-revealjs/unnamed-chunk-8-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="correlation-3" class="slide level2">
<h2>Correlation</h2>
<div class="cell panel-fill" data-layout-align="center">
<div class="cell-output-display">
<div class="container-fluid">
<div class="row">
<div class="col-sm-3">
<div class="form-group shiny-input-container">
<label class="control-label" id="a-label" for="a">a:</label>
<input id="a" type="number" class="form-control" value="1.5" min="-10" max="10">
</div>
</div>
<div class="col-sm-3">
<div class="form-group shiny-input-container">
<label class="control-label" id="b-label" for="b">b:</label>
<input id="b" type="number" class="form-control" value="0.5" min="-10" max="10">
</div>
</div>
<div class="col-sm-3">
<div class="form-group shiny-input-container">
<label class="control-label" id="SD-label" for="SD">SD:</label>
<input id="SD" type="number" class="form-control" value="1" min="0" max="10">
</div>
</div>
<div class="col-sm-3">
<div class="form-group shiny-input-container">
<label class="control-label" id="n-label" for="n">n:</label>
<input id="n" type="number" class="form-control" value="30" min="1" max="200">
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div class="shiny-plot-output html-fill-item" id="plot" style="width:1000px;height:500px;"></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="examples" class="slide level2">
<h2>Examples</h2>

<img data-src="images/correlation2.jpg" class="r-stretch"></section>
<section id="be-careful" class="slide level2">
<h2>Be careful</h2>
<p>The <font color="blue">Anscombe quartet</font>:</p>
<p>All examples below have a correlation of <span class="math inline">\(r = .70\)</span></p>

<img data-src="images/anscombe.png" class="r-stretch"></section>
<section id="calculating-correlations" class="slide level2 smaller">
<h2>Calculating Correlations</h2>
<p><strong>Step 1:</strong> Calculate means</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(X_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y_i\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">11</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">12</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="math inline">\(\text{Mean } X = \frac{\sum{X_i}}{n} = \frac{1+2+4+5+5+7}{ 6} = 4\)</span></p>
<p><span class="math inline">\(\text{Mean } Y = \frac{\sum{Y_i}}{n} = \frac{0+2+3+2+11+12}{6} = 5\)</span></p>
</section>
<section id="calculating-correlations-1" class="slide level2 smaller">
<h2>Calculating Correlations</h2>
<p><strong>Step 2:</strong> Calculate deviations from mean</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(X_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\((X_i-\bar{X})\)</span></th>
<th style="text-align: center;"><span class="math inline">\((Y_i-\bar{Y})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">-5</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">-3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-2</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">7</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="math inline">\(\text{Mean } X = \frac{\sum{X_i}}{n} = \frac{0+2+3+2+11+12}{6} = 4\)</span></p>
<p><span class="math inline">\(\text{Mean } Y = \frac{\sum{Y_i}}{n} = \frac{0+2+3+2+11+12}{6} = 5\)</span></p>
</section>
<section id="calculating-correlations-2" class="slide level2 smaller">
<h2>Calculating Correlations</h2>
<p><strong>Step 3:</strong> Square deviations</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table>
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(X_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\((X_i-\bar{X})\)</span></th>
<th style="text-align: center;"><span class="math inline">\((Y_i-\bar{Y})\)</span></th>
<th style="text-align: center;"><span class="math inline">\((X_i-\bar{X})^2\)</span></th>
<th style="text-align: center;"><span class="math inline">\((Y_i-\bar{Y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">-5</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">36</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">49</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="calculating-correlations-3" class="slide level2 smaller">
<h2>Calculating Correlations</h2>
<p><strong>Step 4:</strong> Total sum of squares / variance / standard deviations</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table>
<colgroup>
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 22%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(X_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\((X_i-\bar{X})\)</span></th>
<th style="text-align: center;"><span class="math inline">\((Y_i-\bar{Y})\)</span></th>
<th style="text-align: center;"><span class="math inline">\((X_i-\bar{X})^2\)</span></th>
<th style="text-align: center;"><span class="math inline">\((Y_i-\bar{Y})^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">-5</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">36</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">49</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="math inline">\(SS = \sum{(X_i-\bar{X})^2} = 9 + 4 + 0 + 1 + 1 +9\)</span></p>
<p><span class="math inline">\(s^2 = var = \frac{\sum{(X_i-\bar{X})^2}}{n-1} = \frac{24}{5} = 4.8\)</span></p>
<p><span class="math inline">\(s = SD = \sqrt{s^2} = \sqrt{2.2}\)</span></p>
</section>
<section id="calculating-correlations-4" class="slide level2 smaller">
<h2>Calculating Correlations</h2>
<p><strong>Step 5:</strong> Calculate COvariance</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table style="width:100%;">
<colgroup>
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(X_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\(Y_i\)</span></th>
<th style="text-align: center;"><span class="math inline">\((X_i-\bar{X})\)</span></th>
<th style="text-align: center;"><span class="math inline">\((Y_i-\bar{Y})\)</span></th>
<th style="text-align: center;"><span class="math inline">\((X_i-\bar{X})^2\)</span></th>
<th style="text-align: center;"><span class="math inline">\((Y_i-\bar{Y})^2\)</span></th>
<th style="text-align: center;"><span class="math inline">\((X_i-\bar{X})(Y_i-\bar{Y})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">-5</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">25</td>
<td style="text-align: center;">15</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">-3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">11</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">36</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">7</td>
<td style="text-align: center;">9</td>
<td style="text-align: center;">49</td>
<td style="text-align: center;">21</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Covariance is a rough, unstandardized measure of association</li>
<li>It is somewhat comparable to sums of squares (although technically it is a sum of products)</li>
</ul>
</section>
<section id="calculating-correlations-5" class="slide level2 smaller">
<h2>Calculating Correlations</h2>
<p><strong>Step 6:</strong> Standardize the covariance</p>
<p><strong>Correlation:</strong></p>
<p><span class="math display">\[
r = \frac{COV_{XY}}{SD_X * SD_Y}
\]</span></p>
<p><strong>Regression coefficient:</strong></p>
<p><span class="math display">\[
b = \frac{COV_{XY}}{S^2_X} = \frac{COV_{XY}}{SD_X*SD_X}
\]</span></p>
</section>
<section id="calculating-correlations-6" class="slide level2 smaller">
<h2>Calculating Correlations</h2>
<p><strong>Step 6:</strong> Standardize the covariance</p>
<p>Correlation and regression coefficients are just different ways to standardize the covariance</p>
<ul>
<li>Correlation is standardized with respect to X and Y
<ul>
<li>Correlation of X with Y is the same as correlation of Y with X</li>
</ul></li>
<li>Regression coefficient is only standardized with respect to X
<ul>
<li>That’s why its units are Y (a 1-step increase in X leads to <span class="math inline">\(b\)</span> steps increase in Y)</li>
<li>That’s why it’s asymmetrical; regression slope of X on Y is different from Y on X</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="standardized-regression-coefficient" class="title-slide slide level1 center">
<h1>Standardized regression coefficient</h1>

</section>
<section id="standardized-regression-coefficient-1" class="slide level2">
<h2>Standardized regression coefficient</h2>
<p>Remember: The correlation coefficient is standardized by dropping the units of both variables</p>
<p>The standardized regression coefficient does the same</p>
<p>Consequently, in bivariate linear regression, the standardized regression coefficient <em>is</em> the correlation coefficient</p>
<ul>
<li>This changes when we have &gt;1 predictors (future lesson)</li>
</ul>
</section>
<section id="computation-of-the-standardized-regression-coefficient" class="slide level2">
<h2>Computation of the standardized regression coefficient</h2>
<p>Compute Z-scores for predictor and outcome</p>
<ul>
<li><span class="math inline">\(Z_X = \frac{X_i-\bar{X}}{SD_x}\)</span>, <span class="math inline">\(Z_Y = \frac{Y_i-\bar{Y}}{SD_Y}\)</span></li>
<li>Z-scores have mean 0 and SD 1</li>
</ul>
<p>Then perform regression with these Z-scores</p>
</section>
<section id="spss-output" class="slide level2">
<h2>SPSS output</h2>

<img data-src="images/regression_correlation.png" class="r-stretch"><p>
<script type="application/shiny-prerendered" data-context="server-start">
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
set.seed(42/101)
Hours = abs(rnorm(92, 4, 2))
Grade = abs(3 + (7/9)*Hours)+rnorm(92)
Grade[Grade > 10] <- 10 - (Grade[Grade > 10] - 10)
studentdata <- data.frame(Grade=Grade, Hours=Hours)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
output$plot <- renderPlot({
  set.seed(1)
  X = rnorm(input$n)
  Y <- input$a + input$b*X + rnorm(input$n, sd = input$SD)
  df_cor <- data.frame(
    X = X,
    Y = Y
  )
  res <- lm(X~Y, df_cor)
  ggplot(df_cor, aes(x=X, y=Y))+
    geom_point()+
    #geom_hline(yintercept = 0)+geom_vline(xintercept = 0)+
    theme_bw()+
    scale_x_continuous(limits = c(-5,5)) +
    scale_y_continuous(limits = c(-5,5)) +
    stat_smooth(method = "lm",
              formula = y ~ x,
              geom = "smooth",
              se=FALSE)+
    #geom_abline(intercept = coef(res)[1], slope = coef(res)[2], colour = "red")+
    geom_label(x = 5, y = -5, hjust = 1, vjust = 0, label = paste0("Yi = ", formatC(coef(res)[1], digits = 2, format = "f"), " + ", formatC(coef(res)[2], digits = 2, format = "f"), "*Xi + ei,\nr = ", formatC(cor(df_cor$X, df_cor$Y), digits = 2, format = "f")))
})
</script>
 
<script type="application/shiny-prerendered" data-context="server-extras">
ojs_define <- function(..., .session = shiny::getDefaultReactiveDomain()) {
  quos <- rlang::enquos(...)
  vars <- rlang::list2(...)
  nm <- names(vars)
  if (is.null(nm)) {
    nm <- rep_len("", length(vars))
  }
  mapply(function(q, nm, val) {
    # Infer name, if possible
    if (nm == "") {
      tryCatch({
        nm <- rlang::as_name(q)
      }, error = function(e) {
        code <- paste(collapse = "\n", deparse(rlang::f_rhs(q)))
        stop("ojs_define() could not create a name for the argument: ", code)
      })
    }
    .session$output[[nm]] <- val
    outputOptions(.session$output, nm, suspendWhenHidden = FALSE)
    .session$sendCustomMessage("ojs-export", list(name = nm))
    NULL
  }, quos, nm, vars, SIMPLIFY = FALSE, USE.NAMES = FALSE)
  invisible()
}
</script>
</p>
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["3.6.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["1.7.4"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.4.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["www/shared/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","accessibility/js/bootstrap-accessibility.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css","accessibility/css/bootstrap-accessibility.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["shiny"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["1.7.4"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->

<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131]}},"value":[{"type":"character","attributes":{},"value":["abind","backports","bain","base","bayesplot","blavaan","boot","bslib","cachem","callr","car","carData","checkmate","cli","coda","codetools","colorspace","compiler","CompQuadForm","crayon","curl","dagitty","data.table","datasets","dbscan","digest","dplyr","ellipsis","evaluate","fansi","farver","fastDummies","fastmap","future","future.apply","generics","ggplot2","globals","glossary","glue","graphics","grDevices","grid","gridExtra","gsubfn","gtable","htmltools","httpuv","httr","igraph","inline","jquerylib","jsonlite","kableExtra","knitr","labeling","later","lattice","lavaan","lifecycle","listenv","loo","magrittr","MASS","Matrix","matrixStats","methods","mime","mnormt","MplusAutomation","munsell","mvtnorm","nlme","nonnest2","OpenMx","pander","parallel","parallelly","pbivnorm","pillar","pkgbuild","pkgconfig","plyr","prettyunits","processx","progressr","promises","proto","ps","psych","quadprog","R6","RANN","Rcpp","RcppParallel","rlang","rmarkdown","rstan","rstantools","rstudioapi","rvest","sandwich","sass","scales","shiny","StanHeaders","stats","stats4","stringi","stringr","svglite","systemfonts","texreg","tibble","tidyselect","tidySEM","tmvnsim","tools","utf8","utils","V8","vctrs","viridisLite","webexercises","webshot","withr","xfun","xml2","xtable","yaml","zoo"]},{"type":"character","attributes":{},"value":["1.4-5","1.4.1","0.2.8","4.3.0","1.10.0","0.4-7","1.3-28.1","0.5.0","1.0.8","3.7.3","3.1-2","3.0-5","2.2.0","3.6.1","0.19-4","0.2-19","2.1-0","4.3.0","1.4.3","1.5.2","5.0.1","0.3-1","1.14.8","4.3.0","1.1-11","0.6.31","1.1.2","0.3.2","0.21","1.0.4","2.1.1","1.6.3","1.1.1","1.32.0","1.11.0","0.1.3","3.4.2","0.16.2","1.0.0","1.6.2","4.3.0","4.3.0","4.3.0","2.3","0.7","0.3.3","0.5.5","1.6.11","1.4.6","1.4.3","0.3.19","0.1.4","1.8.5","1.3.4","1.43","0.4.2","1.3.1","0.21-8","0.6-15","1.0.3","0.9.0","2.6.0","2.0.3","7.3-60","1.5-4.1","1.0.0","4.3.0","0.12","2.1.1","1.1.0","0.5.0","1.2-1","3.1-162","0.5-5","2.21.8","0.6.5","4.3.0","1.36.0","0.6.0","1.9.0","1.4.0","2.0.3","1.8.8","1.1.1","3.8.1","0.13.0","1.2.0.1","1.0.0","1.7.5","2.3.3","1.5-8","2.5.1","2.6.1","1.0.10","5.1.7","1.1.1","2.22","2.21.8","2.3.1","0.14","1.0.3","3.0-2","0.4.6","1.2.1","1.7.4","2.26.26","4.3.0","4.3.0","1.7.12","1.5.0","2.1.1","1.0.4","1.38.6","3.2.1","1.2.0","0.2.5.4","1.0-2","4.3.0","1.2.3","4.3.0","4.3.0","0.6.2","0.4.2","1.1.0","0.5.4","2.5.0","0.39","1.3.4","1.8-4","2.3.7","1.8-12"]}]}]}
</script>
<!--/html_preserve-->
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="lecture6_sums_squares_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="lecture6_sums_squares_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>